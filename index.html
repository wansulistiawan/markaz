<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yayasan Markaz Yatim Duafa Qurani - Beranda</title>
    
    <!-- Script & Font -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Times+New+Roman&display=swap" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>

    <!-- Bagian CSS untuk Styling. -->
    <style>
        :root {
            --primary-color: #2c5e2e;
            --secondary-color: #ffc107;
            --light-gray: #f8f9fa;
            --dark-gray: #343a40;
            --success-color: #28a745;
            --error-color: #dc3545;
            --info-color: #0d6efd; 
            --info-color-hover: #0b5ed7;
        }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--light-gray);
            color: var(--dark-gray);
            line-height: 1.7;
        }
        .container { width: 90%; max-width: 1200px; margin: 0 auto; padding: 20px 0; }
        header { background-color: #ffffff; padding: 20px 0; border-bottom: 1px solid #e9ecef; }
        header .header-content { display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 20px; }
        header .logo-container { display: flex; align-items: center; }
        header img.logo { height: 60px; margin-right: 15px; }
        header .title-container h1 { margin: 0; font-size: 1.8em; color: var(--primary-color); }
        header .title-container p { margin: 0; font-size: 0.9em; color: #6c757d; }
        #date-display { text-align: right; font-size: 0.9em; color: var(--dark-gray); line-height: 1.5; }
        #date-display .hijri-date { font-weight: 500; color: var(--primary-color); }
        .header-right-items { display: flex; align-items: center; gap: 20px; flex-wrap: wrap; }
        nav { background-color: var(--primary-color); padding: 5px 0; position: sticky; top: 0; z-index: 1000; }
        nav .nav-container { display: flex; align-items: center; flex-wrap: nowrap; width: 90%; max-width: 1200px; margin: 0 auto; overflow-x: auto; }
        nav a { color: #ffffff; padding: 15px 20px; text-decoration: none; font-weight: 500; transition: background-color 0.3s; border-radius: 4px; white-space: nowrap; }
        nav a:hover, nav a.active { background-color: #1e4220; }
        #attendanceNav { background-color: var(--error-color); }
        #attendanceNav:hover, #attendanceNav.active { background-color: #c82333; }
        #sistemInformasiNav { background-color: var(--info-color); }
        #sistemInformasiNav:hover, #sistemInformasiNav.active { background-color: var(--info-color-hover); }
        #userProfile { display: flex; align-items: center; gap: 15px; color: var(--dark-gray); font-weight: bold; cursor: pointer; padding: 5px 10px; border-radius: 6px; transition: background-color 0.3s; }
        #userProfile:hover { background-color: var(--light-gray); }
        #userProfileName { max-width: 150px; line-height: 1.2; text-align: left; word-break: break-word; }
        #navProfilePic { width: 80px; height: 80px; border-radius: 50%; object-fit: cover; border: 3px solid #e9ecef; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .auth-button { color: #212529; border-radius: 5px; padding: 10px 20px; font-weight: bold; border: none; cursor: pointer; text-decoration: none; display: inline-block; text-align: center; transition: background-color 0.3s; }
        #loginButton { background-color: var(--secondary-color); }
        #loginButton:hover { background-color: #e0a800; }
        #marquee-container { background-color: var(--secondary-color); color: var(--dark-gray); padding: 10px 0; overflow: hidden; white-space: nowrap; box-sizing: border-box; position: sticky; top: 60px; z-index: 999; }
        #marquee-text-wrapper { display: inline-block; padding-left: 100%; animation: marquee 200s linear infinite; }
        @keyframes marquee { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }
        .hero { position: relative; color: #ffffff; text-align: center; overflow: hidden; height: 450px; display: flex; align-items: center; justify-content: center; width: 100%; }
        .slideshow-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }
        .slide { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-size: cover; background-position: center; opacity: 0; transition: opacity 1.5s ease-in-out; transform: scale(1.05); animation: kenburns 30s infinite; }
        .slide.active { opacity: 1; }
        .hero-content { position: relative; z-index: 2; background-color: rgba(0, 0, 0, 0.5); padding: 20px 40px; border-radius: 8px; }
        @keyframes kenburns { 0% { transform: scale(1.05); } 100% { transform: scale(1.2); } }
        .hero h2 { font-size: 2.5em; md:font-size: 3em; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.7); }
        .hero p { font-size: 1.1em; md:font-size: 1.2em; max-width: 700px; margin: 0 auto 20px auto; }
        .hero .cta-button { background-color: var(--success-color); color: #ffffff; padding: 15px 30px; text-decoration: none; border-radius: 5px; font-size: 1.1em; font-weight: bold; transition: background-color 0.3s; cursor: pointer; }
        .hero .cta-button:hover { background-color: #218838; }
        .page-section { scroll-margin-top: 120px; }
        .page-section.hidden { display: none; }
        .section { background-color: #ffffff; padding: 30px; margin-bottom: 30px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .section h2 { font-size: 2em; color: var(--primary-color); border-bottom: 3px solid var(--secondary-color); padding-bottom: 10px; margin-bottom: 20px; }
        .grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .card { border: 1px solid #e9ecef; border-radius: 8px; overflow: hidden; transition: box-shadow 0.3s; display: flex; flex-direction: column; }
        .card:hover { box-shadow: 0 6px 12px rgba(0,0,0,0.1); }
        .card img { width: 100%; height: 200px; object-fit: cover; }
        .card-content { padding: 20px; flex-grow: 1; }
        .card-content h3 { margin-top: 0; }
        .card-content .meta { font-size: 0.8em; color: #6c757d; margin-bottom: 10px; }
        .calendar-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; }
        .calendar-month { background-color: #fff; padding: 1rem; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); display: flex; flex-direction: column; }
        .calendar-grid .holiday { color: #dc2626; font-weight: 500; }
        .event-green { background-color: #d1fae5; }
        .event-lightblue { background-color: #dbeafe; }
        .event-darkblue { background-color: #c7d2fe; }
        .event-yellow { background-color: #fef9c3; }
        .event-orange { background-color: #ffedd5; }
        .today { position: relative; color: #ffffff !important; font-weight: 700; z-index: 1; }
        .today::before { content: ''; position: absolute; top: 50%; left: 50%; width: 2.25rem; height: 2.25rem; background-color: #2563eb; border-radius: 50%; z-index: -1; transform: translate(-50%, -50%); animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: translate(-50%, -50%) scale(0.95); box-shadow: 0 0 0 0 rgba(37, 99, 235, 0.7); } 70% { transform: translate(-50%, -50%) scale(1); box-shadow: 0 0 0 10px rgba(37, 99, 235, 0); } 100% { transform: translate(-50%, -50%) scale(0.95); box-shadow: 0 0 0 0 rgba(37, 99, 235, 0); } }
        footer { background-color: var(--dark-gray); color: var(--light-gray); padding: 40px 0; text-align: center; }
        footer p { margin: 5px 0; }
        footer a { color: var(--secondary-color); text-decoration: none; }
        .custom-form { max-width: 600px; margin: 40px auto; padding: 30px; background: #ffffff; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: bold; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 12px; border: 1px solid #ced4da; border-radius: 5px; box-sizing: border-box; }
        .submit-btn { width: 100%; padding: 15px; background: var(--primary-color); color: #ffffff; border: none; border-radius: 5px; font-size: 1.1em; cursor: pointer; transition: background-color 0.3s; }
        .submit-btn:hover { background: #1e4220; }
        .submit-btn:disabled { background-color: #6c757d; cursor: not-allowed; }
        .password-container { position: relative; }
        .toggle-password { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); cursor: pointer; user-select: none; color: #6c757d; }
        .remember-me { display: flex; align-items: center; justify-content: space-between; font-size: 0.9em; }
        .remember-me label { margin: 0 0 0 8px; font-weight: normal; }
        .forgot-password { color: var(--primary-color); text-decoration: none; }
        .forgot-password:hover { text-decoration: underline; }
        .role-selector { display: flex; gap: 10px; margin-bottom: 20px; border: 1px solid #ccc; border-radius: 8px; padding: 5px; }
        .role-selector label { flex: 1; text-align: center; padding: 10px; border-radius: 6px; cursor: pointer; transition: all 0.3s ease; }
        .role-selector input[type="radio"] { display: none; }
        .role-selector input[type="radio"]:checked + label { background-color: var(--primary-color); color: white; font-weight: bold; }
        .profile-picture-container { display: flex; flex-direction: column; align-items: center; gap: 15px; margin-bottom: 20px; }
        #profilePicturePreview { width: 120px; height: 120px; border-radius: 50%; object-fit: cover; border: 4px solid #e9ecef; }
        #profilePictureInput { display: none; }
        #uploadPictureLabel { background-color: var(--secondary-color); color: var(--dark-gray); padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); animation: fadeIn 0.3s; }
        .modal-content { background-color: #fefefe; margin: 5% auto; padding: 30px; border: 1px solid #888; width: 90%; max-width: 600px; border-radius: 8px; position: relative; animation: slideIn 0.4s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideIn { from { transform: translateY(-50px); } to { transform: translateY(0); } }
        .close-button { color: #aaa; position: absolute; top: 10px; right: 20px; font-size: 28px; font-weight: bold; }
        .close-button:hover, .close-button:focus { color: black; text-decoration: none; cursor: pointer; }
        .download-btn { display: block; width: fit-content; margin: 10px auto 0 auto; padding: 10px 25px; background-color: var(--primary-color); color: white; text-decoration: none; border-radius: 5px; font-weight: bold; transition: background-color 0.3s; }
        .download-btn:hover { background-color: #1e4220; }
        .message-box { position: fixed; top: -100px; left: 50%; transform: translateX(-50%); padding: 15px 25px; border-radius: 8px; color: white; font-weight: bold; z-index: 3000; box-shadow: 0 4px 10px rgba(0,0,0,0.2); transition: top 0.5s ease-in-out; }
        .message-box.show { top: 20px; }
        .message-box.success { background-color: var(--success-color); }
        .message-box.error { background-color: var(--error-color); }
        .hidden { display: none !important; }
        .schedule-grid { display: grid; grid-template-columns: 90px repeat(6, 1fr); gap: 4px; }
        .time-slot { font-weight: 600; text-align: center; padding: 8px 4px; position: sticky; left: 0; z-index: 15; background-color: #f1f5f9; }
        .day-header { font-weight: 600; text-align: center; padding: 8px 4px; position: sticky; top: 110px; /* Adjusted for nav + marquee */ z-index: 10; background-color: #f1f5f9; }
        .schedule-grid > .day-header:first-child { left: 0; z-index: 20; }
        .schedule-cell { border: 1px solid #e2e8f0; border-radius: 8px; padding: 8px; min-height: 120px; transition: all 0.3s ease-in-out; background-color: white; display: flex; flex-direction: column; }
        .subject { flex-grow: 1; }
        .highlight { background-color: #f0fdfa; border-color: #14b8a6; transform: scale(1.03); z-index: 10; position: relative; animation: glow-animation 2s ease-in-out infinite; }
        .dimmed { opacity: 0.3; filter: grayscale(80%); }
        @keyframes glow-animation { 0% { box-shadow: 0 0 5px rgba(20, 184, 166, 0.5); } 50% { box-shadow: 0 0 20px 5px rgba(20, 184, 166, 0.8); } 100% { box-shadow: 0 0 5px rgba(20, 184, 166, 0.5); } }
        .room-rbm { background-color: #fff7ed; border-color: #fb923c; border-style: dashed; }
        .room-rbm .subject { font-style: italic; color: #c2410c; }
        .room-madinah { background-color: rgba(59, 130, 246, 0.1); border-color: #60a5fa; }
        .room-mekah { background-color: rgba(132, 204, 22, 0.1); border-color: #a3e635; }
        .arrow-icon { transition: transform 0.3s ease-in-out; }
        .rotate-180 { transform: rotate(180deg); }
        .tab-btn, .semester-btn { transition: all 0.2s ease-in-out; }
        .tab-btn.active, .semester-btn.active { background-color: #0d9488; color: white; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); }
        .filter-select { -webkit-appearance: none; -moz-appearance: none; appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 0.75rem center; background-size: 1em; padding-right: 2.5rem; }
        #khs-container { font-family: 'Times New Roman', Times, serif; }
        #khs-display table td, #khs-display table th { padding: 2px 4px; }
        @media print { @page { size: A4 landscape; margin: 1cm; } body { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; } #filter-section, #schedule-actions, #teacher-data-container, #module-data-container, #santri-data-container, #krs-container, #khs-container, header, #tabs-container, #semester-tabs-container, #mainNav, #marquee-container, footer, .auth-section, #date-display { display: none !important; } #main-content { padding: 0; margin: 0; } #schedule-container { box-shadow: none; border: none; padding: 0; overflow: visible; max-height: none; } .schedule-grid { font-size: 8pt; gap: 1px; border: 1px solid #ccc; } .schedule-cell { min-height: auto; padding: 4px; border: 1px solid #eee; } .highlight, .dimmed { transform: none; opacity: 1; filter: none; animation: none; box-shadow: none !important; } .schedule-cell.highlight { border: 1px solid #14b8a6; background-color: #f0fdfa !important; } }
    </style>
</head>
<body>
    <div id="messageBox" class="message-box"></div>

    <header>
        <div class="container header-content">
            <div class="logo-container">
                <img src="logo_yayasan.png" alt="Logo Yayasan" class="logo" onerror="this.onerror=null;this.src='https://placehold.co/60x60/2c5e2e/ffffff?text=Y';">
                <div class="title-container">
                    <h1>Yayasan Markaz Yatim Duafa Qurani</h1>
                    <p>Berdasarkan Al-Qur'an dan Sunnah Sesuai Pemahaman Salafush Shalih</p>
                </div>
            </div>
            <div class="header-right-items">
                <div id="date-display"></div>
                <div class="auth-section">
                    <div id="userProfile" class="hidden">
                        <img id="navProfilePic" src="https://placehold.co/80x80/e9ecef/343a40?text=F" alt="Foto Profil">
                        <span id="userProfileName"></span>
                    </div>
                    <a href="#login" id="loginButton" class="auth-button">Login</a>
                </div>
            </div>
        </div>
    </header>

    <nav id="mainNav">
        <div class="nav-container">
            <a href="#beranda" class="active">Beranda</a>
            <a href="#lembaga">Lembaga</a>
            <a href="#tentang">Tentang</a>
            <a href="#absensi" id="attendanceNav" class="hidden">Absensi</a>
            <a href="#sistem-informasi" id="sistemInformasiNav" class="hidden">Sistem Informasi</a>
            <a href="#penerimaan">Penerimaan</a>
            <a href="#kegiatan">Kegiatan</a>
            <a href="#legalitas">Legalitas</a>
            <a href="#mitra">Mitra</a>
        </div>
    </nav>
    
    <div id="marquee-container" class="hidden">
        <div id="marquee-text-wrapper">
            <span id="marquee-text"></span>
        </div>
    </div>

    <div id="beranda" class="page-section">
        <section class="hero">
            <div id="slideshow" class="slideshow-container"></div>
            <div class="hero-content">
                <h2>Membina Generasi Qur'ani, Memuliakan Yatim & Dhuafa</h2>
                <p>Menjadi bagian dari kebaikan dengan mendukung program pendidikan penghafal Al-Qur'an dan menyantuni mereka yang membutuhkan.</p>
                <a id="donasiBtn" class="cta-button">Donasi Sekarang</a>
            </div>
        </section>
        <main class="container">
            <section id="berita" class="section">
                <h2>Berita & Pengumuman Terbaru</h2>
                <div id="news-container" class="grid-container"></div>
            </section>
            <section id="kalenderPendidikanSection" class="section hidden">
                <h2>Kalender Pendidikan Madrasah 2025/2026</h2>
                <div id="dynamic-calendar-grid" class="calendar-grid"></div>
                <footer class="text-center mt-12 text-gray-500 text-sm">
                    <p>Direktur Jenderal Pendidikan Islam, TTD, Suyitno</p>
                </footer>
            </section>
        </main>
    </div>
    <div id="lembaga" class="page-section hidden container section"><h2>Lembaga di Bawah Naungan Kami</h2><div class="grid-container"><div class="card"><div class="card-content"><h3>Lembaga Pendidikan: Rumah Tahfidz Qur'an Markaz Qur'an Al-Maa'un</h3><p>Fokus pada pendidikan dan pembinaan generasi muda untuk menjadi penghafal Al-Qur'an yang berakhlak mulia.</p></div></div><div class="card"><div class="card-content"><h3>Lembaga Sosial: Rumah Anak Yatim Abu Darda</h3><p>Memberikan perlindungan, kasih sayang, dan pemenuhan kebutuhan hidup bagi anak-anak yatim dan dhuafa.</p></div></div></div></div>
    <div id="tentang" class="page-section hidden container section"><h2>Tentang Yayasan</h2><p><strong>Yayasan Markaz Yatim Duafa Qurani</strong> adalah organisasi nirlaba berlandaskan Al-Qur'an dan Sunnah dengan pemahaman Salafus Shalih.</p><h3>Visi & Misi</h3><p>Menjadi yayasan Islam yang unggul dan amanah dalam mencetak generasi Qur'ani serta menjadi pelopor dalam kesejahteraan sosial umat.</p></div>
    <div id="absensi" class="page-section hidden container section"><h2>Formulir Absensi</h2><p>Silakan pilih peran Anda dan isi formulir di bawah ini.</p><div class="role-selector"><input type="radio" id="roleGuru" name="role" value="guru" checked><label for="roleGuru">Guru</label><input type="radio" id="roleStaf" name="role" value="staf"><label for="roleStaf">Staf</label><input type="radio" id="roleRapat" name="role" value="rapat"><label for="roleRapat">Rapat</label></div><form id="attendanceFormGuru" class="custom-form"> <div class="form-group"><label for="teacherNameDisplay">Nama Guru</label><input type="text" id="teacherNameDisplay" readonly style="background-color: #e9ecef;"></div><div class="form-group"><label for="attendanceDateGuru">Tanggal</label><input type="date" id="attendanceDateGuru" required></div><div class="form-group"><label for="className">Kelas</label><select id="className" class="w-full p-3 border border-gray-300 rounded-md" required><option value="">Pilih Kelas...</option></select></div><div class="form-group"><label for="lateMinutesGuru">Menit Terlambat</label><input type="number" id="lateMinutesGuru" min="0" placeholder="Isi hanya jika terlambat"></div><div class="form-group"><label for="remarksGuru">Keterangan</label><textarea id="remarksGuru" rows="3"></textarea></div><button type="submit" class="submit-btn">Kirim Absensi Guru</button></form><form id="attendanceFormStaf" class="custom-form hidden"><div class="form-group"><label for="stafNameDisplay">Nama Staf</label><input type="text" id="stafNameDisplay" readonly style="background-color: #e9ecef;"></div><div class="form-group"><label for="attendanceDateStaf">Tanggal</label><input type="date" id="attendanceDateStaf" required></div><div class="form-group"><label for="jabatanStaf">Jabatan</label><input type="text" id="jabatanStaf" readonly required style="background-color: #e9ecef;"></div><div class="form-group"><label for="lateMinutesStaf">Menit Terlambat</label><input type="number" id="lateMinutesStaf" min="0" placeholder="Isi hanya jika terlambat"></div><div class="form-group"><label for="remarksStaf">Keterangan</label><textarea id="remarksStaf" rows="3"></textarea></div><button type="submit" class="submit-btn">Kirim Absensi Staf</button></form><form id="attendanceFormRapat" class="custom-form hidden"><div class="form-group"><label for="rapatNameDisplay">Nama</label><input type="text" id="rapatNameDisplay" readonly style="background-color: #e9ecef;"></div><div class="form-group"><label for="rapatDate">Tanggal</label><input type="date" id="rapatDate" readonly style="background-color: #e9ecef;"></div><div class="form-group"><label for="rapatStartTime">Jam Mulai</label><input type="time" id="rapatStartTime" required></div><div class="form-group"><label for="rapatEndTime">Jam Selesai</label><input type="time" id="rapatEndTime" required></div><div class="form-group"><label for="rapatRemarks">Keterangan Rapat</label><textarea id="rapatRemarks" rows="3" required></textarea></div><button type="submit" class="submit-btn">Kirim Absensi Rapat</button></form></div>
    
    <div id="sistem-informasi" class="page-section hidden">
        <main id="main-content" class="flex-1 p-4 md:p-6 lg:p-8">
            <header class="text-center mb-6">
                <h1 class="text-3xl md:text-4xl font-bold text-teal-800">Roster KBM Dinamis</h1>
                <h2 class="text-xl md:text-2xl font-semibold text-teal-700">Markaz Qur'an Al-Maa'un</h2>
            </header>
            <div id="filter-section" class="bg-white p-3 rounded-xl shadow-md mb-6">
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 items-center">
                    <select id="filter-group" class="filter-select w-full pl-3 pr-10 py-2 text-sm border-slate-300 focus:outline-none focus:ring-teal-500 focus:border-teal-500 rounded-md">
                        <option value="all">Semua Kelompok</option>
                        <option value="KF">Kelas Fondasi</option>
                        <option value="KG">Kelas Gabungan</option>
                    </select>
                    <select id="filter-cluster" class="filter-select w-full pl-3 pr-10 py-2 text-sm border-slate-300 focus:outline-none focus:ring-teal-500 focus:border-teal-500 rounded-md" disabled>
                        <option value="all">Semua Klaster</option>
                        <option value="LKS">Literasi & Kreatif Syariah</option>
                        <option value="STT">Sains & Teknologi Terapan</option>
                    </select>
                    <select id="filter-teacher" class="filter-select w-full pl-3 pr-10 py-2 text-sm border-slate-300 focus:outline-none focus:ring-teal-500 focus:border-teal-500 rounded-md">
                        <option value="all">Semua Guru</option>
                    </select>
                    <select id="filter-room" class="filter-select w-full pl-3 pr-10 py-2 text-sm border-slate-300 focus:outline-none focus:ring-teal-500 focus:border-teal-500 rounded-md">
                        <option value="all">Semua Ruang</option>
                        <option value="Kelas Mekah">Kelas Mekah</option>
                        <option value="Kelas Madinah">Kelas Madinah</option>
                        <option value="RBM">RBM</option>
                    </select>
                    <button id="reset-filters" class="w-full bg-teal-600 text-white py-2 px-4 rounded-md hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition text-sm">Reset Filter</button>
                </div>
            </div>
            <div id="semester-tabs-container" class="mb-2 flex space-x-2">
                <button id="semester-ganjil-btn" class="semester-btn flex-1 p-2 rounded-md font-semibold active">Semester Ganjil</button>
                <button id="semester-genap-btn" class="semester-btn flex-1 p-2 rounded-md font-semibold">Semester Genap</button>
            </div>
            <div id="ganjil-tabs">
                <div id="tabs-container" class="mb-4 bg-slate-200 p-1 rounded-lg flex space-x-1">
                    <button id="tab-bulan1" class="tab-btn flex-1 p-2 rounded-md font-semibold active">Bulan I</button>
                    <button id="tab-bulan2" class="tab-btn flex-1 p-2 rounded-md font-semibold">Bulan II</button>
                    <button id="tab-bulan3" class="tab-btn flex-1 p-2 rounded-md font-semibold">Bulan III</button>
                    <button id="tab-bulan4" class="tab-btn flex-1 p-2 rounded-md font-semibold">Bulan IV</button>
                </div>
            </div>
            <div id="genap-tabs" class="hidden">
                 <div id="tabs-container-genap" class="mb-4 bg-slate-200 p-1 rounded-lg flex space-x-1">
                    <button id="tab-bulan5" class="tab-btn flex-1 p-2 rounded-md font-semibold">Bulan V</button>
                    <button id="tab-bulan6" class="tab-btn flex-1 p-2 rounded-md font-semibold">Bulan VI</button>
                    <button id="tab-bulan7" class="tab-btn flex-1 p-2 rounded-md font-semibold">Bulan VII</button>
                    <button id="tab-bulan8" class="tab-btn flex-1 p-2 rounded-md font-semibold">Bulan VIII</button>
                </div>
            </div>
            <div id="schedule-container" class="bg-white p-2 rounded-xl shadow-lg overflow-auto max-h-[80vh]"></div>
            <div id="schedule-actions" class="flex justify-center gap-4 mt-6">
                <button id="reset-schedule" class="flex items-center gap-2 bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd" /></svg> Reset Jadwal</button>
                <button id="print-schedule" class="flex items-center gap-2 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5 4v3H4a2 2 0 00-2 2v3a2 2 0 002 2h1v3a2 2 0 002 2h6a2 2 0 002-2v-3h1a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z" clip-rule="evenodd" /></svg> Cetak</button>
                <button id="download-schedule-pdf" class="flex items-center gap-2 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" /></svg> Unduh Jadwal (PDF)</button>
            </div>
            <div id="teacher-data-container" class="mt-8 bg-white rounded-xl shadow-lg"><div class="data-header flex justify-between items-center p-4 cursor-pointer"><h3 class="text-2xl font-bold text-teal-800">Data Guru</h3><svg class="w-6 h-6 text-teal-800 arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg></div><div class="data-content p-4 sm:p-6 border-t border-slate-200 hidden"><div class="overflow-x-auto"><table id="teacher-table" class="min-w-full divide-y divide-slate-200"><thead class="bg-slate-100"><tr><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider w-16">No</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Nama Guru</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Bidang / Jurusan</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Hari</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Jadwal (Slot Waktu)</th></tr></thead><tbody class="bg-white divide-y divide-slate-200"></tbody></table></div></div></div>
            <div id="module-data-container" class="mt-8 bg-white rounded-xl shadow-lg"><div class="data-header flex justify-between items-center p-4 cursor-pointer"><h3 class="text-2xl font-bold text-teal-800">Perpustakaan Modul</h3><svg class="w-6 h-6 text-teal-800 arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg></div><div class="data-content p-4 sm:p-6 border-t border-slate-200 hidden"><div class="overflow-x-auto"><table id="module-table" class="min-w-full"><thead class="bg-slate-100"><tr><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider" colspan="7">Guru & Modul</th></tr></thead><tbody class="bg-white"></tbody></table></div></div></div>
            <div id="santri-data-container" class="mt-8 bg-white rounded-xl shadow-lg"><div class="data-header flex justify-between items-center p-4 cursor-pointer"><h3 class="text-2xl font-bold text-teal-800">Data Santri</h3><svg class="w-6 h-6 text-teal-800 arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg></div><div class="data-content p-4 sm:p-6 border-t border-slate-200 hidden"><div class="overflow-x-auto"><table id="santri-table" class="min-w-full divide-y divide-slate-200"><thead class="bg-slate-100"><tr><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">No</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Nama Santri</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Jenis Kelamin</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Kelompok</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Kelas</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Jurusan</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Aksi</th></tr></thead><tbody id="santri-table-body" class="bg-white divide-y divide-slate-200"></tbody></table></div></div></div>
            <div id="krs-container" class="mt-8 mb-8 p-4 sm:p-6 rounded-xl shadow-lg bg-gray-50 hidden"><div id="krs-display" class="mx-auto bg-white rounded-xl shadow-lg p-6 md:p-8" style="width: 210mm;"><header class="text-center border-b-2 border-gray-200 pb-4 mb-6"><h1 class="text-2xl md:text-3xl font-bold text-gray-800">KARTU RENCANA STUDI (KRS)</h1><h2 class="text-lg md:text-xl font-semibold text-gray-700 mt-1">Markaz Qur'an Al-Maa'un</h2><p class="text-md text-gray-600">Semester Ganjil</p></header><section id="info-santri-krs" class="mb-8"><div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 text-sm text-gray-700"><div class="flex"><span class="w-36 font-semibold">Nama Santri</span><span id="nama-santri-krs">: </span></div><div class="flex"><span class="w-48 font-semibold">Total SKS yang bisa diambil</span><span id="total-sks-ambil-krs">: 40 sks</span></div><div class="flex"><span class="w-36 font-semibold">Jurusan</span><span id="jurusan-krs">: </span></div><div class="flex"><span class="w-48 font-semibold">Kelas</span><span id="kelas-krs">: </span></div><div class="flex"><span class="w-36 font-semibold">Kelompok</span><span id="kelompok-krs">: </span></div><div class="flex"><span class="w-48 font-semibold">Materi untuk Bulan ke</span><span id="materi-bulan-krs">: </span></div></div></section><section><div class="overflow-x-auto"><table id="tabel-krs" class="w-full text-sm text-left text-gray-600"><thead class="text-xs text-gray-700 uppercase bg-gray-100"><tr><th scope="col" class="px-4 py-3">Hari</th><th scope="col" class="px-4 py-3">Waktu</th><th scope="col" class="px-4 py-3">Kode</th><th scope="col" class="px-4 py-3">Mata Pelajaran / Modul</th><th scope="col" class="px-4 py-3">Ruang</th><th scope="col" class="px-4 py-3 text-center">SKS</th><th scope="col" class="px-4 py-3">Guru</th><th scope="col" class="px-4 py-3">Aksi</th></tr></thead><tbody id="krs-table-body"></tbody><tfoot><tr class="font-semibold text-gray-900 bg-gray-100"><td colspan="5" class="px-4 py-3 text-right">Total SKS yang Diambil</td><td id="total-sks-diambil" class="px-4 py-3 text-center">0</td><td colspan="2" class="px-4 py-3"></td></tr></tfoot></table></div></section></div><div class="mt-8 text-center flex justify-center items-center gap-4"><button id="add-krs-row" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-6 rounded-lg shadow-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-teal-400 focus:ring-opacity-50">+ Tambah Baris</button><button id="download-krs-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg shadow-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 inline-flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg><span>Unduh PDF</span></button><button id="close-krs-btn-bottom" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-6 rounded-lg shadow-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50">Tutup</button></div></div>
            <div id="khs-container" class="mt-8 mb-8 p-4 sm:p-6 rounded-xl shadow-lg bg-gray-50 hidden"><div id="khs-display" class="mx-auto bg-white rounded-xl shadow-lg p-6 md:p-8" style="width: 210mm;"></div><div class="mt-8 text-center flex justify-center items-center gap-4"><button id="download-khs-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg shadow-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 inline-flex items-center"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg><span>Unduh PDF</span></button><button id="close-khs-btn-bottom" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-6 rounded-lg shadow-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50">Tutup</button></div></div>
        </main>
        <div id="confirmation-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 hidden"><div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"><div class="mt-3 text-center"><div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100"><svg class="h-6 w-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg></div><h3 class="text-lg leading-6 font-medium text-gray-900 mt-2" id="modal-title">Konfirmasi</h3><div class="mt-2 px-7 py-3"><p class="text-sm text-gray-500" id="modal-message">Apakah Anda yakin?</p></div><div class="items-center px-4 py-3"><button id="modal-confirm-btn" class="px-4 py-2 bg-red-500 text-white text-base font-medium rounded-md w-auto shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500">Ya, Lanjutkan</button><button id="modal-cancel-btn" class="px-4 py-2 bg-gray-200 text-gray-800 text-base font-medium rounded-md w-auto ml-2 shadow-sm hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-300">Batal</button></div></div></div></div>
    </div>

    <div id="penerimaan" class="page-section hidden container section"><h2>Informasi Penerimaan</h2><p>Informasi penerimaan santri baru akan diumumkan di sini.</p></div>
    <div id="kegiatan" class="page-section hidden container section"><h2>Galeri Kegiatan</h2><div id="gallery-container" class="grid-container"></div></div>
    <div id="legalitas" class="page-section hidden container section"><h2>Akreditas & Legalitas</h2><ul><li><strong>Akta Notaris:</strong> Nomor 12 Tgl 10 Feb 2022</li><li><strong>SK Kemenkumham:</strong> AHU-0004281.AH.01.04.Tahun 2022</li><li><strong>NPWP:</strong> 63.382.276.2-115.000</li></ul></div>
    <div id="mitra" class="page-section hidden container section"><h2>Mitra Kebaikan</h2><p>Kami bekerja sama dengan berbagai pihak, termasuk <strong>Yayasan Sahabat Yatim Indonesia</strong>.</p></div>
    <div id="login" class="page-section hidden container"><form id="loginForm" class="custom-form"><h2 style="text-align: center;">Login Pengurus / Staf</h2><div class="form-group"><label for="username">Username</label><input type="text" id="username" name="username" required></div><div class="form-group password-container"><label for="password">Password</label><input type="password" id="password" name="password" required><span class="toggle-password"></span></div><div class="form-group remember-me"><div><input type="checkbox" id="remember" name="remember"><label for="remember">Ingat saya selama 30 hari</label></div><a href="#" id="forgotPasswordLink" class="forgot-password">Lupa Sandi?</a></div><button type="submit" class="submit-btn">Masuk</button></form></div>
    <div id="donasiModal" class="modal"><div class="modal-content"><span class="close-button">&times;</span><h2>Tata Cara Donasi</h2><p>Silakan transfer ke <strong>Bank BRI: 7040-0102-7168535</strong> a/n Markaz Yatim Duafa Qurani.</p><p style="text-align:center; margin-top:1rem;">Atau scan QRIS:</p><img src="qrisdonasi.png" alt="QRIS Donasi" style="width:250px;display:block;margin:15px auto;border-radius:8px;" onerror="this.onerror=null;this.src='https://placehold.co/250x250/cccccc/FFFFFF?text=QRIS+Error';"><a href="qrisdonasi.png" class="download-btn" download="qrisdonasi.png">Unduh QRIS</a><p>Konfirmasi ke <strong>085261804096</strong>.</p></div></div>
    <div id="profileModal" class="modal"><div class="modal-content"><span class="close-button">&times;</span><h2>Profil Saya</h2><form id="profileForm"><div class="profile-picture-container"><img id="profilePicturePreview" src="https://placehold.co/128x128/e9ecef/343a40?text=Foto" alt="Foto Profil"><input type="file" id="profilePictureInput" accept="image/*"><label for="profilePictureInput" id="uploadPictureLabel">Ganti Foto</label></div><div class="form-group"><label for="profileName">Nama Profil</label><input type="text" id="profileName" required></div><div class="form-group"><label for="profileDob">Tanggal Lahir</label><input type="date" id="profileDob"></div><div class="form-group"><label for="profileAddress">Alamat</label><textarea id="profileAddress" rows="3"></textarea></div><div class="form-group"><label for="profileJabatan">Jabatan</label><input type="text" id="profileJabatan"></div><div class="form-group"><label for="profileUsername">Username</label><input type="text" id="profileUsername" required readonly style="background-color:#e9ecef;cursor:not-allowed;"></div><div style="display:flex;gap:10px;margin-top:20px;"><button type="submit" class="submit-btn" style="flex:1;">Simpan</button><button type="button" id="changePasswordFromProfile" class="auth-button" style="flex:1;background-color:var(--secondary-color);">Ganti Sandi</button><button type="button" id="logoutFromProfile" class="auth-button" style="flex:1;background-color:var(--error-color);color:white;">Logout</button></div></form></div></div>
    <div id="changePasswordModal" class="modal"><div class="modal-content"><span class="close-button">&times;</span><h2>Ganti Kata Sandi</h2><form id="changePasswordForm"><div class="form-group password-container"><label for="currentPassword">Sandi Saat Ini</label><input type="password" id="currentPassword" required><span class="toggle-password"></span></div><div class="form-group password-container"><label for="newPassword">Sandi Baru</label><input type="password" id="newPassword" required><span class="toggle-password"></span></div><div class="form-group password-container"><label for="confirmNewPassword">Konfirmasi Sandi Baru</label><input type="password" id="confirmNewPassword" required><span class="toggle-password"></span></div><button type="submit" class="submit-btn">Simpan</button></form></div></div>
    <div id="forgotPasswordModal" class="modal"><div class="modal-content"><span class="close-button">&times;</span><div id="forgotPasswordStep1"><h2>Lupa Kata Sandi</h2><form id="forgotPasswordVerifyForm"><div class="form-group"><label for="forgotUsername">Username</label><input type="text" id="forgotUsername" required></div><div class="form-group"><label for="forgotDob">Tanggal Lahir</label><input type="date" id="forgotDob" required></div><button type="submit" class="submit-btn">Verifikasi</button></form></div><div id="forgotPasswordStep2" class="hidden"><h2>Atur Ulang Sandi</h2><form id="forgotPasswordResetForm"><div class="form-group password-container"><label for="forgotNewPassword">Sandi Baru</label><input type="password" id="forgotNewPassword" required><span class="toggle-password"></span></div><div class="form-group password-container"><label for="forgotConfirmPassword">Konfirmasi Sandi Baru</label><input type="password" id="forgotConfirmPassword" required><span class="toggle-password"></span></div><button type="submit" class="submit-btn">Simpan</button></form></div></div></div>
    <footer><div class="container"><p>&copy; 2025 Yayasan Markaz Yatim Duafa Qurani. Semua Hak Cipta Dilindungi.</p><p>Jl. Protokol Desa Sei Kamah II, Sei Dadap, Asahan, Sumut | <a href="mailto:markazyatimduafaqurani@gmail.com">markazyatimduafaqurani@gmail.com</a> | 085261804096</p></div></footer>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // --- DATA GLOBAL ---
        const CONFIG = { SCRIPT_URL: "https://script.google.com/macros/s/AKfycbw6Kh6UpyLS9prJTeZ8WO16csV7Hu8fKX8pGJqrW4Fs8r70SOL_Sd2dh9JqYFfGCsMdMA/exec", CLOUDINARY_URL: "https://api.cloudinary.com/v1_1/deva5eknr/image/upload", CLOUDINARY_UPLOAD_PRESET: "markaz", ICONS: { eye: `<svg class="eye-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>`, eyeOff: `<svg class="eye-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>` } };
        const appData = { 
            heroImages: ["anakdidik.jpg", "anakdidik01.jpg", "anakdidik02.jpg", "anakdidik03.jpg", "anakdidik04.jpg"],
            news: [ { img: 'https://placehold.co/400x200/28a745/FFFFFF?text=Penerimaan+Santri', title: 'Penerimaan Santri Baru Telah Dibuka!', meta: '30 Juli 2025 | Pendidikan', desc: 'Pendaftaran santri baru untuk program Tahfidz di Markaz Qur\'an Al-Maa\'un telah resmi dibuka.' }, { img: 'https://placehold.co/400x200/17a2b8/FFFFFF?text=Santunan+Yatim', title: 'Santunan Rutin Anak Yatim', meta: '25 Juli 2025 | Sosial', desc: 'Kegiatan santunan bulanan untuk anak-anak yatim binaan Rumah Anak Yatim Abu Darda.' }, { img: 'https://placehold.co/400x200/ffc107/FFFFFF?text=Kajian+Umum', title: 'Kajian Umum Bulanan', meta: '22 Juli 2025 | Dakwah', desc: 'Yayasan akan mengadakan kajian umum terbuka untuk masyarakat. Informasi lokasi akan diumumkan segera.' } ], 
            gallery: [ { img: 'https://placehold.co/400x250/6f42c1/FFFFFF?text=Halaqah+Tahfidz', title: 'Halaqah Tahfidz Pagi', desc: 'Para santri sedang menyetorkan hafalan Al-Qur\'an kepada Musyrif.' }, { img: 'https://placehold.co/400x250/fd7e14/FFFFFF?text=Buka+Puasa+Bersama', title: 'Buka Puasa Bersama', desc: 'Kegiatan buka puasa bersama anak-anak yatim dan dhuafa di bulan Ramadhan.' }, { img: 'https://placehold.co/400x250/20c997/FFFFFF?text=Penyaluran+Bantuan', title: 'Penyaluran Bantuan', desc: 'Distribusi bantuan sembako dari para donatur kepada masyarakat sekitar.' } ], 
            calendarEvents: [ { date: "2025-07-14", title: "Pengenalan Lingkungan Madrasah", color: "event-green", span: 3 }, { date: "2025-08-17", title: "Hari Kemerdekaan RI", color: "holiday" }, { date: "2025-09-05", title: "Maulid Nabi Muhammad SAW", color: "holiday" }, { date: "2025-12-01", title: "Penilaian Akhir Semester (PAS)", color: "event-lightblue", span: 12 }, { date: "2025-12-13", title: "Penerimaan Rapor", color: "event-darkblue" }, { date: "2025-12-15", title: "Libur Akhir Semester", color: "event-orange", span: 17 }, { date: "2026-01-01", title: "Tahun Baru Masehi 2026", color: "holiday" }, { date: "2026-01-05", title: "Awal Masuk Semester Genap", color: "" }, { date: "2026-01-26", title: "Isra Mi'raj Nabi Muhammad SAW", color: "holiday" }, { date: "2026-02-23", title: "Perkiraan Libur Awal Ramadan", color: "event-yellow", span: 3 }, { date: "2026-02-26", title: "Awal Puasa Ramadan 1447 H", color: "holiday" }, { date: "2026-03-20", title: "Perkiraan Libur Idul Fitri", color: "event-yellow", span: 12 }, { date: "2026-03-28", title: "Hari Raya Idul Fitri 1447 H", color: "holiday", span: 2 }, { date: "2026-04-01", title: "Perkiraan Libur Idul Fitri", color: "event-yellow", span: 4 }, { date: "2026-05-01", title: "Hari Buruh Internasional", color: "holiday" }, { date: "2026-06-01", title: "Hari Lahir Pancasila", color: "holiday" }, { date: "2026-06-01", title: "Penilaian Akhir Tahun (PAT)", color: "event-lightblue", span: 12 }, { date: "2026-06-04", title: "Hari Raya Idul Adha 1447 H", color: "holiday" }, { date: "2026-06-13", title: "Penerimaan Rapor", color: "event-darkblue" }, { date: "2026-06-14", title: "Tahun Baru Islam 1448 H", color: "holiday" }, { date: "2026-06-15", title: "Libur Akhir Tahun", color: "event-orange", span: 28 } ],
            schedules: {
                bulan1: [
                    { day: "Senin", time: "08:00-09:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "Wajib", subject: "MAT-101: Operasi Bilangan Bulat & KPK/FPB", teacher: "Sulistiawan, S.Kom", downloadLink: "https://url-penyimpanan-anda.com/modul/MAT-101.pdf" },
                    { day: "Senin", time: "08:00-09:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "Wajib", subject: "MAT-101: Operasi Bilangan Bulat & KPK/FPB", teacher: "Sulistiawan, S.Kom", downloadLink: "https://url-penyimpanan-anda.com/modul/MAT-101.pdf" },
                    { day: "Senin", time: "10:00-11:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "Wajib", subject: "IND-101: Menyimak Efektif: Adab & Teknik", teacher: "Mia A. Lubis, S.Kom", downloadLink: "https://drive.google.com/file/d/1PAGwVSmVj3_JFW6mekxZGK7xZh54XlDH/view?usp=drive_link" },
                    { day: "Senin", time: "10:00-11:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "STT", subject: "THI-201: Pengantar Thibbun Nabawi", teacher: "Sulistiawan, S.Kom", downloadLink: "https://drive.google.com/file/d/1ZjmZkzVknCL8sNPz4nWwaARTN62AN1qG/view" },
                    { day: "Senin", time: "13:00-14:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "Wajib", subject: "ENG-101: Greetings & Introductions", teacher: "Ariyanti R. Siregar, S.Kom", downloadLink: "https://drive.google.com/file/d/1LYRMv43xr0ei9aHJ4Rm8VVGEZv2LMoJT/view?usp=drive_link" },
                    { day: "Senin", time: "13:00-14:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "LKS", subject: "KWU-201: Riset Pasar & Analisis Kompetitor", teacher: "Sulistiawan, S.Kom", downloadLink: "https://drive.google.com/file/d/1ibVSjYmLhxxAhmAm_EGJ-qowFDPy3aZ_/view?usp=drive_link" },
                    { day: "Selasa", time: "08:00-09:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "", subject: "ARB-101: ABY Jilid 1A Unit 1-2 (Perkenalan & Keluarga)", teacher: "Erwan Syahputra, S.Pd", downloadLink: "https://drive.google.com/file/d/1KNuZMEsYPEznGzEcyhTR5GDb5J3gUwM5/view?usp=drive_link" },
                    { day: "Selasa", time: "08:00-09:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "Wajib", subject: "PANC-201: Implementasi nilai-nilai Pancasila Dalam Kehidupan", teacher: "Sulistiawan, S.Kom", downloadLink: "https://drive.google.com/file/d/1V0ZYiN9sYr5ZYXR3yfk5p80uLFNlbv9g/view?usp=drive_link" },
                    { day: "Selasa", time: "10:00-11:30", sks: 2, room: "Kelas Mekah", group: "KG", cluster: "Wajib", subject: "ARB-201: ABY Jilid 1B Unit 7-8 (Pendidikan & Pekerjaan)", teacher: "Erwan Syahputra, S.Pd", downloadLink: "https://drive.google.com/file/d/19dfcrahHUBSjFQx0bNvcGDxm2gJw35Tt/view?usp=drive_link" },
                    { day: "Selasa", time: "10:00-11:30", sks: 2, room: "Kelas Madinah", group: "KF", cluster: "", subject: "KTR-101: Pertolongan Pertama Pada Kecelakaan (P3K)", teacher: "Sulistiawan, S.Kom", downloadLink: "https://drive.google.com/file/d/1X7OG1Z2rdwVPn4B8VqZM--wV7zDddOFw/view?usp=drive_link" },
                    { day: "Selasa", time: "13:00-14:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "", subject: "TAU-101: Makna & Konsekuensi 2 Kalimat Syahadat", teacher: "Erwan Syahputra, S.Pd", downloadLink: "https://drive.google.com/file/d/11yClAXt_5YcDrzyZ9-Ee4fJOSIwGQWcK/view?usp=drive_link" },
                    { day: "Selasa", time: "13:00-14:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "Wajib", subject: "IPA-201: Gerak Lurus dan Gaya", teacher: "Sulistiawan, S.Kom", downloadLink: "https://drive.google.com/file/d/170mKM_vLYEeO0tIUOP063-k1wMW1a1jD/view?usp=drive_link" },
                    { day: "Rabu", time: "08:00-09:30", sks: 2, room: "Kelas Mekah", group: "KG", cluster: "LKS", subject: "ULH-201: Pengantar Ilmu Hadits (Definisi & Sejarah)", teacher: "Erwan Syahputra, S.Pd", downloadLink: "https://drive.google.com/file/d/1b839aBuE0qPkPX5TISgiloV3qGljV2EF/view?usp=drive_link" },
                    { day: "Rabu", time: "08:00-09:30", sks: 2, room: "Kelas Madinah", group: "KF", cluster: "", subject: "KWU-101: Pengantar Mindset Wirausaha Muslim", teacher: "Sulistiawan, S.Kom", downloadLink: "https://drive.google.com/file/d/1OY6JWCfKPjxgKECTDUoWadrY_eoMMdCj/view?usp=drive_link" },
                    { day: "Rabu", time: "08:00-09:30", sks: 2, room: "RBM", group: "KG", cluster: "STT", subject: "TME-201: Pengenalan Alat-Alat Servis", teacher: "Aria Atmaja", downloadLink: "https://drive.google.com/file/d/1tgiZzRH8P-WWtoNdtRWkJW8qGDBcrU8b/view?usp=drive_link" },
                    { day: "Rabu", time: "10:00-11:30", sks: 2, room: "Kelas Madinah", group: "KF", cluster: "", subject: "IPS-101: Aku & Lingkungan Sekitarku", teacher: "Mia A. Lubis, S.Kom", downloadLink: "https://drive.google.com/file/d/1FlPhTpeWb9ARmQRa8g-dV74_tabkmwFI/view?usp=drive_link" },
                    { day: "Rabu", time: "10:00-11:30", sks: 2, room: "Kelas Mekah", group: "KG", cluster: "Wajib", subject: "PAI-201: Public Speaking 1: Struktur Pidato & Mengatasi Gugup", teacher: "SupraSojo, S.Pd.I., M.Pd.", downloadLink: "https://drive.google.com/file/d/1HlMC_lIGb7L9rDr2MocXm3VCMP6uqyeg/view?usp=drive_link" },
                    { day: "Rabu", time: "13:00-14:30", sks: 2, room: "Kelas Mekah", group: "KG", cluster: "Wajib", subject: "ENG-201: Hobbies & Free Time", teacher: "Ariyanti R. Siregar, S.Kom", downloadLink: "https://drive.google.com/file/d/15-9a1S4ogBTjKjG6i2_268-tLqrquC4P/view?usp=drive_link" },
                    { day: "Rabu", time: "13:00-14:30", sks: 2, room: "Kelas Madinah", group: "KF", cluster: "", subject: "HAD-101: Hadits Arba'in 1 (Hafalan & Makna Hadits #1-5)", teacher: "Zhofri F. Majdi, S.Sos", downloadLink: "https://drive.google.com/file/d/1pND30uoMlg5Dqyzm5C4_Yl27_H5LXHh9/view?usp=drive_link" },
                    { day: "Kamis", time: "08:00-09:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "Wajib", subject: "TIK-101: Pengenalan Perangkat Keras & Lunak Komputer", teacher: "Sulistiawan, S.Kom", downloadLink: "https://drive.google.com/file/d/1JTJjRA_rWZ-62_W82aBKL23b2K0244bL/view?usp=drive_link" },
                    { day: "Kamis", time: "08:00-09:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "Wajib", subject: "TAU-201: Studi Kitab Tauhid 1", teacher: "Zhofri F. Majdi, S.Sos", downloadLink: "https://drive.google.com/file/d/1WoluRi1U0edST8BBaqPkLNiEIZLCPwvt/view?usp=drive_link" },
                    { day: "Kamis", time: "10:00-11:30", sks: 2, room: "Kelas Mekah", group: "KG", cluster: "STT", subject: "TIK-201: Pengolah Kata (Word) Lanjutan", teacher: "Mia A. Lubis, S.Kom", downloadLink: "https://drive.google.com/file/d/1KzWoTzH_VqgVjd-0Sc3z9Xmwz7Z19TSX/view?usp=drive_link" },
                    { day: "Kamis", time: "10:00-11:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "LKS", subject: "IPS-201: Masuk dan Berkembangnya Islam di Nusantara", teacher: "Sulistiawan, S.Kom", downloadLink: "https://drive.google.com/file/d/1X0S3XBjJEdEkKCGAUjcDze8Kfh2MWjuG/view?usp=drive_link" },
                    { day: "Kamis", time: "13:00-14:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "", subject: "IPA-101: Ciri Makhluk Hidup & Klasifikasi Sederhana", teacher: "Ariyanti R. Siregar, S.Kom", downloadLink: "https://drive.google.com/file/d/1x-u8VWwCD2KJW16-wG0z_ZBrmbAb4Lpf/view?usp=drive_link" },
                    { day: "Kamis", time: "13:00-14:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "Wajib", subject: "ULQ-201: Sejarah Penulisan & Pengumpulan Al-Qur'an", teacher: "Zhofri F. Majdi, S.Sos", downloadLink: "https://drive.google.com/file/d/1b_WMo_1KKAWPXKzilPSKsFzNzUmdW4V8/view?usp=drive_link" },
                    { day: "Jumat", time: "08:00-09:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "", subject: "FIQ-101: Wudhu & Tayammum", teacher: "Zhofri F. Majdi, S.Sos", downloadLink: "https://drive.google.com/file/d/1ZLRZNGtttzsv0KQ7E9S2vezp3ma5vfwE/view?usp=drive_link" },
                    { day: "Jumat", time: "08:00-09:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "LKS", subject: "NAH-201: Tanda-tanda I'rab untuk Isim", teacher: "M. Ryza Anshori, S.Pd", downloadLink: "https://drive.google.com/file/d/1WX-53Q4hY5gvzAVbKsEjLHKACWgKo1K1/view?usp=drive_link" },
                    { day: "Jumat", time: "10:00-11:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "", subject: "SIR-101: Kondisi Dunia Sebelum Kenabian & Masa Kecil Nabi", teacher: "Zhofri F. Majdi, S.Sos", downloadLink: "https://drive.google.com/file/d/1uULQr6lFC2YylJ4ZdcktlUXbgKEPzdp-/view?usp=drive_link" },
                    { day: "Jumat", time: "10:00-11:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "LKS", subject: "BAL-101: Pengantar Ilmu Balaghah", teacher: "M. Ryza Anshori, S.Pd", downloadLink: "https://drive.google.com/file/d/1UyC0-W-l-Xfli8SSvpMcihgiuFc1zYS0/view?usp=drive_link" },
                    { day: "Sabtu", time: "08:00-09:30", sks: 2, room: "Kelas Mekah", group: "KG", cluster: "Wajib", subject: "TAF-201: Tafsir & Tadabbur Surat Al-Maa'un & Al-Kafirun", teacher: "Zhofri F. Majdi, S.Sos", downloadLink: "https://drive.google.com/file/d/1uy5pOjhibrZbLUOUfRJHNKtqV4AT6obY/view?usp=drive_link" },
                    { day: "Sabtu", time: "08:00-09:30", sks: 2, room: "Kelas Madinah", group: "KF", cluster: "", subject: "AKH-101: Adab Kepada Allah", teacher: "Erwan Syahputra, S.Pd", downloadLink: "https://drive.google.com/file/d/1bXBq9UzfDsnIxEnh1cMHZchqlEHB8etK/view?usp=drive_link" },
                    { day: "Sabtu", time: "10:00-11:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "", subject: "TAF-101: Tafsir & Tadabbur Surat Al-Fatihah", teacher: "Zhofri F. Majdi, S.Sos", downloadLink: "https://drive.google.com/file/d/1XyXIN1bsnIKVeGX3_H9MkaGlgrB2dhCu/view?usp=drive_link" },
                    { day: "Sabtu", time: "10:00-11:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "Wajib", subject: "IND-201: Membaca 3 (Membedakan Fakta & Opini dalam Teks)", teacher: "Mia A. Lubis, S.Kom", downloadLink: "https://drive.google.com/file/d/12D_Sk1hB2q5e3BdNX1-Iw8kIjTrm6UId/view?usp=drive_link" },
                    { day: "Sabtu", time: "13:00-14:30", sks: 2, room: "Kelas Mekah", group: "KG", cluster: "Wajib", subject: "SIR-201: Peristiwa Boikot & Wafatnya Khadijah dan Abu Thalib", teacher: "Zhofri F. Majdi, S.Sos", downloadLink: "https://drive.google.com/file/d/1vJCQq48tCQNX_S5X8NF3DqTE9weOhGse/view?usp=drive_link" },
                    { day: "Sabtu", time: "13:00-14:30", sks: 2, room: "Kelas Madinah", group: "KF", cluster: "", subject: "NAH-101: Pengenalan Kalimat (Jumlah Mufidah) & Jenis Kata", teacher: "Mahadi Sentosa, S.Sos", downloadLink: "https://drive.google.com/file/d/1kbTKODSzvge5WUbkRA5wpf3SJl8WVXci/view?usp=drive_link" },
                ],
                bulan2: [
                    { day: "Senin", time: "08:00-09:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "Wajib", subject: "MAT-102: Pecahan & Desimal", teacher: "Sulistiawan, S.Kom", downloadLink: "https://drive.google.com/file/d/14mAyOGGZXxbiC0OM9lUWFkY3xzkpDCD2/view?usp=drive_link" },
                    { day: "Senin", time: "08:00-09:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "Wajib", subject: "MAT-102: Pecahan & Desimal", teacher: "Sulistiawan, S.Kom", downloadLink: "https://drive.google.com/file/d/14mAyOGGZXxbiC0OM9lUWFkY3xzkpDCD2/view?usp=drive_link" },
                    { day: "Senin", time: "10:00-11:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "Wajib", subject: "IND-102: Berbicara 1: Perkenalan Diri & Sapaan Santun", teacher: "Mia A. Lubis, S.Kom", downloadLink: "https://drive.google.com/file/d/12C3tX82DIS6BqYBt2DdKlvCRKTgNzX8Y/view?usp=drive_link" },
                    { day: "Senin", time: "10:00-11:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "Wajib", subject: "AKH-202: Adab kepada Orang Tua & Guru (Gabungan)", teacher: "SupraSojo, S.Pd.I., M.Pd.", downloadLink: "https://drive.google.com/file/d/1k_P5RN0TS25K_3K3yc4yMNGsOj1qOtE2/view?usp=drive_link" },
                    { day: "Senin", time: "13:00-14:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "Wajib", subject: "ENG-102: Classroom Objects & Instructions", teacher: "Ariyanti R. Siregar, S.Kom", downloadLink: "https://drive.google.com/file/d/1q2btB5Fv1-ifXl9n7tOLT9bk1CmpsMYt/view?usp=drive_link" },
                    { day: "Senin", time: "13:00-14:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "LKS", subject: "KWU-202: Validasi Ide & Model Bisnis Sederhana", teacher: "Sulistiawan, S.Kom", downloadLink: "https://drive.google.com/file/d/1rR-udDxso8F9x2pExZTfemJoiZQDknDn/view?usp=drive_link" },
                    { day: "Selasa", time: "08:00-09:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "", subject: "ARB-102: ABY Jilid 1A: Unit 3-4 (Tempat Tinggal & Kehidupan Harian)", teacher: "Erwan Syahputra, S.Pd", downloadLink: "https://drive.google.com/file/d/1_YO9Z4NlH6JjtycqQCZC7i26IZdS_K3M/view?usp=drive_link" },
                    { day: "Selasa", time: "08:00-09:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "STT", subject: "THI-202: Hifzhu Shihhah (Pola Hidup Sehat Rasulullah ﷺ)", teacher: "Sulistiawan, S.Kom", downloadLink: "https://drive.google.com/file/d/10qcUn-Ycfqfw03SiS2F2zZg8TbGHu4_E/view?usp=drive_link" },
                    { day: "Selasa", time: "10:00-11:30", sks: 2, room: "Kelas Mekah", group: "KG", cluster: "Wajib", subject: "ARB-202: ABY Jilid 1B: Unit 9-10 (Berbelanja & Cuaca)", teacher: "Erwan Syahputra, S.Pd", downloadLink: "https://drive.google.com/file/d/14EF5H4lZaA-Kx4WHvIqL3_WxDNhtEj3F/view?usp=drive_link" },
                    { day: "Selasa", time: "10:00-11:30", sks: 2, room: "Kelas Madinah", group: "KF", cluster: "", subject: "KTR-102: Manajemen Kesehatan Dasar & Penyakit Umum", teacher: "Sulistiawan, S.Kom", downloadLink: "https://drive.google.com/file/d/1ROzqQ6HtB3t4UwQLVuGGZBwE6uZO8_Zc/view?usp=drive_link" },
                    { day: "Selasa", time: "13:00-14:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "", subject: "TAU-102: Studi Kitab Tauhid 1", teacher: "Erwan Syahputra, S.Pd", downloadLink: "https://drive.google.com/file/d/1qjYbEFYXgoJa5oBrE8-D3-8XcpML3qfc/view?usp=drive_link" },
                    { day: "Selasa", time: "13:00-14:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "Wajib", subject: "IPA-202: Sistem Gerak pada Manusia (Rangka & Sendi)", teacher: "Sulistiawan, S.Kom", downloadLink: "https://drive.google.com/file/d/16GiZXYA0pLnivjI-AgZxa0cs1bm5onLt/view?usp=drive_link" },
                    { day: "Rabu", time: "08:00-09:30", sks: 2, room: "Kelas Mekah", group: "KG", cluster: "LKS", subject: "ULH-202: Klasifikasi Hadits (Shahih, Hasan, Dha'if)", teacher: "Erwan Syahputra, S.Pd", downloadLink: "https://drive.google.com/file/d/15Wdnf8x9oqPhjhurjqJC8eEN5VlG51uY/view?usp=drive_link" },
                    { day: "Rabu", time: "08:00-09:30", sks: 2, room: "Kelas Madinah", group: "KF", cluster: "", subject: "KWU-102: Dasar-dasar Produk Halal & Thayyib", teacher: "Sulistiawan, S.Kom", downloadLink: "https://drive.google.com/file/d/1RAq8tygsge8GoCBrhn21gnHbDnu4pbZy/view?usp=drive_link" },
                    { day: "Rabu", time: "08:00-09:30", sks: 2, room: "RBM", group: "KG", cluster: "STT", subject: "TME-202: Praktik Menggunakan Alat Tangan & Solder", teacher: "Aria Atmaja", downloadLink: "https://drive.google.com/file/d/1g6ZMvLvlZz5ML1wFJla4tEsd8Thi6ixr/view?usp=drive_link" },
                    { day: "Rabu", time: "10:00-11:30", sks: 2, room: "Kelas Madinah", group: "KF", cluster: "", subject: "IPS-102: Kebutuhan Manusia & Ekonomi Dasar", teacher: "Mia A. Lubis, S.Kom", downloadLink: "https://drive.google.com/file/d/1X1TZ0rn3LEjpuGPitnEuwU3_4LVC307_/view?usp=drive_link" },
                    { day: "Rabu", time: "10:00-11:30", sks: 2, room: "Kelas Mekah", group: "KG", cluster: "Wajib", subject: "PAI-202: Public Speaking 2: Teknik Vokal & Bahasa Tubuh", teacher: "SupraSojo, S.Pd.I., M.Pd.", downloadLink: "https://drive.google.com/file/d/15A_dulFxCo0C-KfJI8SwDUJ8JHC9chNp/view?usp=drive_link" },
                    { day: "Rabu", time: "13:00-14:30", sks: 2, room: "Kelas Mekah", group: "KG", cluster: "Wajib", subject: "ENG-202: Food & Drinks", teacher: "Ariyanti R. Siregar, S.Kom", downloadLink: "https://drive.google.com/file/d/1tfAqtezxc2QjgaPf8DRrwEFKgsg6FRN9/view?usp=drive_link" },
                    { day: "Rabu", time: "13:00-14:30", sks: 2, room: "Kelas Madinah", group: "KF", cluster: "", subject: "HAD-102: Hadits Arba'in 2 (Hafalan & Makna Hadits #6-10)", teacher: "Zhofri F. Majdi, S.Sos", downloadLink: "https://drive.google.com/file/d/1XJ9TQok3F0kbpDwCI7tp3h16GqeSL6ST/view?usp=drive_link" },
                    { day: "Kamis", time: "08:00-09:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "Wajib", subject: "TIK-102: Sistem Operasi & Manajemen File Dasar", teacher: "Sulistiawan, S.Kom", downloadLink: "https://drive.google.com/file/d/1Hvgbz7Feoo77Y9sN623wZBWTI0rGUBr0/view?usp=drive_link" },
                    { day: "Kamis", time: "08:00-09:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "Wajib", subject: "TAU-202: Studi Kitab Tauhid 2", teacher: "Zhofri F. Majdi, S.Sos", downloadLink: "https://drive.google.com/file/d/17YsFPW2yfT7vAp0NJ_P15maejVzPqvJ-/view?usp=drive_link" },
                    { day: "Kamis", time: "10:00-11:30", sks: 2, room: "Kelas Mekah", group: "KG", cluster: "STT", subject: "TIK-202: Pengolah Angka (Excel) Lanjutan", teacher: "Mia A. Lubis, S.Kom", downloadLink: "https://drive.google.com/file/d/1srJaLqp4ooThoEfI7wtsbFaykdgyu99e/view?usp=drive_link" },
                    { day: "Kamis", time: "10:00-11:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "LKS", subject: "IPS-202: Kerajaan-Kerajaan Islam di Nusantara", teacher: "Sulistiawan, S.Kom", downloadLink: "https://drive.google.com/file/d/1C46LEPWD7RqtMk9VCbSrmgrsfoacOmwx/view?usp=drive_link" },
                    { day: "Kamis", time: "13:00-14:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "", subject: "IPA-102: Zat dan Wujudnya (Padat, Cair, Gas)", teacher: "Ariyanti R. Siregar, S.Kom", downloadLink: "https://drive.google.com/file/d/1RNX57pp79q4_ng6jNbbL9noyIkSVh_za/view?usp=drive_link" },
                    { day: "Kamis", time: "13:00-14:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "Wajib", subject: "ULQ-202: Pengantar Ulumul Qur'an (Makkiyah & Madaniyah)", teacher: "Zhofri F. Majdi, S.Sos", downloadLink: "https://drive.google.com/file/d/1zjGj93zp0Q75e-R910X9rJD3vDwvJjRO/view?usp=drive_link" },
                    { day: "Jumat", time: "08:00-09:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "", subject: "FIQ-102: Shalat 1: Syarat & Rukun Shalat", teacher: "Zhofri F. Majdi, S.Sos", downloadLink: "https://drive.google.com/file/d/1N8ElP99WQz3mtS3Grci-OhJSaIYd7kXc/view?usp=drive_link" },
                    { day: "Jumat", time: "08:00-09:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "LKS", subject: "NAH-202: I'rab Isim Mutsanna & Jamak Mudzakkar Salim", teacher: "M. Ryza Anshori, S.Pd", downloadLink: "https://drive.google.com/file/d/1QwWpcn3ulii4n4C50In2dlF6uPTBTODV/view?usp=drive_link" },
                    { day: "Jumat", time: "10:00-11:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "", subject: "SIR-102: Masa Kenabian & Dakwah di Mekah", teacher: "Zhofri F. Majdi, S.Sos", downloadLink: "https://drive.google.com/file/d/1ru17RARAr5mBS8fXP_tD_2HE3KH41ZeW/view?usp=drive_link" },
                    { day: "Jumat", time: "10:00-11:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "LKS", subject: "BAL-102: Ilmu Ma'ani: Kalam Khabari & Insya'i", teacher: "M. Ryza Anshori, S.Pd", downloadLink: "https://drive.google.com/file/d/1_sbsi-bfwpLPjzgR7G00yOCRj-4fZIIK/view?usp=drive_link" },
                    { day: "Sabtu", time: "08:00-09:30", sks: 2, room: "Kelas Mekah", group: "KG", cluster: "Wajib", subject: "TAF-202: Tafsir & Tadabbur Surat Al-'Asr & Al-Humazah", teacher: "Zhofri F. Majdi, S.Sos", downloadLink: "https://drive.google.com/file/d/14DD1UeZQ-_1UojKNOZ6n_-8Z1BXQlMms/view?usp=drive_link" },
                    { day: "Sabtu", time: "08:00-09:30", sks: 2, room: "Kelas Madinah", group: "KF", cluster: "", subject: "AKH-102: Adab kepada Sesama & Lingkungan", teacher: "Erwan Syahputra, S.Pd", downloadLink: "https://drive.google.com/file/d/1j_-GAHn0VUbq3pjBHRvo2tajQUMcvIyM/view?usp=drive_link" },
                    { day: "Sabtu", time: "10:00-11:30", sks: 2, room: "Kelas Mekah", group: "KF", cluster: "", subject: "TAF-102: Tafsir & Tadabbur Ayat Kursi", teacher: "Zhofri F. Majdi, S.Sos", downloadLink: "https://drive.google.com/file/d/18T2MoUIgArVl5bpl62IiX-lbMa4Xz5Wr/view?usp=drive_link" },
                    { day: "Sabtu", time: "10:00-11:30", sks: 2, room: "Kelas Madinah", group: "KG", cluster: "Wajib", subject: "IND-202: Menulis 3: Membuat Ringkasan & Peta Konsep", teacher: "Mia A. Lubis, S.Kom", downloadLink: "https://drive.google.com/file/d/1EX9Suwx3tz13lBY6ZDl8WbBoh4d925zp/view?usp=drive_link" },
                    { day: "Sabtu", time: "13:00-14:30", sks: 2, room: "Kelas Mekah", group: "KG", cluster: "Wajib", subject: "SIR-202: Peristiwa Isra' Mi'raj & Perintah Shalat", teacher: "Zhofri F. Majdi, S.Sos", downloadLink: "https://drive.google.com/file/d/1bWBklTc9RNC0TC-X2S_4paK5nyU_BrjA/view?usp=drive_link" },
                    { day: "Sabtu", time: "13:00-14:30", sks: 2, room: "Kelas Madinah", group: "KF", cluster: "", subject: "NAH-102: Jumlah Ismiyah (Kalimat Nominal)", teacher: "Mahadi Sentosa, S.Sos", downloadLink: "https://drive.google.com/file/d/1A-2Xy_Z9VgG22wWRI9_dOPJuvVK12mOq/view?usp=drive_link" },
                ],
                bulan3: [], bulan4: [], bulan5: [], bulan6: [], bulan7: [], bulan8: []
            },
            santri: [ { id: 1, nama: "Ahmad Royyan", gender: "Laki-Laki", grup: "KG LKS", kelas: "XII", jurusan: "Bisnis & Manajemen" }, { id: 2, nama: "M. Alvin Ramadhan Lubis", gender: "Laki-Laki", grup: "KF", kelas: "X", jurusan: "Non Jurusan" }, { id: 3, nama: "Abdullah Ridho Selamet", gender: "Laki-Laki", grup: "KG LKS", kelas: "X", jurusan: "Bisnis & Manajemen" }, { id: 4, nama: "Rizki Fadilah", gender: "Laki-Laki", grup: "KF", kelas: "VIII", jurusan: "Non Jurusan" }, { id: 5, nama: "Annisa Akbar Siregar", gender: "Perempuan", grup: "KG STT", kelas: "XII", jurusan: "Agribisnis (Pertanian & Peternakan)" }, { id: 6, nama: "Intan Akbar Siregar", gender: "Perempuan", grup: "KG STT", kelas: "IX", jurusan: "Sains & Teknologi" }, { id: 7, nama: "Aprilia Alvina Rikay", gender: "Perempuan", grup: "KG LKS", kelas: "X", jurusan: "Pendidikan Agama Islam" }, { id: 8, nama: "Aprilia Alvani Rikay", gender: "Perempuan", grup: "KG LKS", kelas: "X", jurusan: "Pendidikan Agama Islam" }, { id: 9, nama: "Rahmah Azizah Lubis", gender: "Perempuan", grup: "KG LKS", kelas: "XI", jurusan: "Tahfidz & Bahasa Arab" }, { id: 10, nama: "Aisyah Az-Zahra", gender: "Perempuan", grup: "KG LKS", kelas: "VIII", jurusan: "Tahfidz & Bahasa Arab" }, { id: 11, nama: "Nur Halimah", gender: "Perempuan", grup: "KG LKS", kelas: "VIII", jurusan: "Tahfidz & Bahasa Arab" }, { id: 12, nama: "Nur Alfia Fauzana", gender: "Perempuan", grup: "KG LKS", kelas: "VIII", jurusan: "Pendidikan Agama Islam" }, { id: 13, nama: "Putri Maharani Br. Tarigan", gender: "Perempuan", grup: "KF", kelas: "VIII", jurusan: "Non Jurusan" }, { id: 14, nama: "Dedek Suci Ramadhani", gender: "Perempuan", grup: "KF", kelas: "VII", jurusan: "Non Jurusan" }, { id: 15, nama: "Aisyah Nur Fadillah", gender: "Perempuan", grup: "KF", kelas: "VII", jurusan: "Non Jurusan" } ],
            teachers: [ { no: 1, name: "Sulistiawan, S.Kom", major: "Pelajaran Umum & Keterampilan", hari: "Semua hari & jam", schedule: "Guru Cadangan" }, { no: 2, name: "Zhofri F. Majdi, S.Sos", major: "Diniyah", hari: "Kamis, Jumat, Sabtu", schedule: "Kamis (08-10), Jumat & Sabtu (Semua Jam)" }, { no: 3, name: "M. Ryza Anshori, S.Pd", major: "Diniyah", hari: "Jumat", schedule: "Semua Jam" }, { no: 4, name: "Erwan Syahputra, S.Pd", major: "Diniyah", hari: "Selasa, Rabu, Sabtu", schedule: "Selasa (Semua Jam), Rabu & Sabtu (sampai 10.00)" }, { no: 5, name: "Ariyanti R. Siregar, S.Kom", major: "Pelajaran Umum", hari: "Senin, Rabu, Kamis", schedule: "12.45 - 14.15" }, { no: 6, name: "Mia A. Lubis, S.Kom", major: "Pelajaran Umum", hari: "Semua Hari", schedule: "10.00 - 12.15 (Guru Cadangan)" }, { no: 7, name: "Mahadi Sentosa, S.Sos", major: "Diniyah", hari: "Sabtu", schedule: "13.00-14.30" }, { no: 8, name: "Suprasojo, S.Pd.I., M.Pd.", major: "Diniyah", hari: "Senin, Rabu", schedule: "8.00-11.30" }, { no: 9, name: "Aria Atmaja", major: "Teknik Mekanik Elektronik", hari: "Rabu", schedule: "08:00-09:30" } ]
        };
        appData.schedules.bulan3 = appData.schedules.bulan2; appData.schedules.bulan4 = appData.schedules.bulan1; appData.schedules.bulan5 = appData.schedules.bulan2; appData.schedules.bulan6 = appData.schedules.bulan1; appData.schedules.bulan7 = appData.schedules.bulan2; appData.schedules.bulan8 = appData.schedules.bulan1;
        
        const ui = { messageBox: document.getElementById('messageBox'), donasiModal: document.getElementById("donasiModal"), donasiBtn: document.getElementById("donasiBtn"), loginButton: document.getElementById('loginButton'), userProfile: document.getElementById('userProfile'), userProfileName: document.getElementById('userProfileName'), navProfilePic: document.getElementById('navProfilePic'), attendanceNav: document.getElementById('attendanceNav'), sistemInformasiNav: document.getElementById('sistemInformasiNav'), kalenderPendidikan: document.getElementById('kalenderPendidikanSection'), marqueeContainer: document.getElementById('marquee-container'), marqueeText: document.getElementById('marquee-text'), dynamicCalendarGrid: document.getElementById('dynamic-calendar-grid'), slideshowContainer: document.getElementById('slideshow') };
        
        function showMessage(message, type = 'error') { ui.messageBox.textContent = message; ui.messageBox.className = `message-box ${type} show`; setTimeout(() => { ui.messageBox.classList.remove('show'); }, 3500); }
        function getActiveSession() { return JSON.parse(localStorage.getItem('userSession') || sessionStorage.getItem('userSession') || 'null'); }

        function showPage(hash) {
            document.querySelectorAll('.page-section').forEach(sec => sec.classList.add('hidden'));
            const targetHash = (hash === '' || hash === '#') ? '#beranda' : hash;
            const sectionToShow = document.querySelector(targetHash);
            if (sectionToShow) {
                sectionToShow.classList.remove('hidden');
                if (targetHash === '#absensi') {
                    const session = getActiveSession();
                    const name = (session && session.userData) ? session.userData.profileName : "Anda harus login";
                    const jabatan = (session && session.userData) ? session.userData.jabatan || '' : "Anda harus login";
                    document.getElementById('teacherNameDisplay').value = name;
                    document.getElementById('stafNameDisplay').value = name;
                    document.getElementById('rapatNameDisplay').value = name;
                    document.getElementById('jabatanStaf').value = jabatan;
                    populateTeacherClasses(session, document.getElementById('attendanceDateGuru').value);
                }
            } else { document.getElementById('beranda').classList.remove('hidden'); }
        }
        function showLoggedInView(userData) {
            ui.loginButton.classList.add('hidden');
            ui.attendanceNav.classList.remove('hidden');
            ui.sistemInformasiNav.classList.remove('hidden');
            ui.kalenderPendidikan.classList.remove('hidden');
            if (userData && userData.profileName) {
                ui.userProfileName.textContent = userData.profileName;
                ui.navProfilePic.src = userData.profilePicture || 'https://placehold.co/80x80/e9ecef/343a40?text=F';
                ui.navProfilePic.onerror = () => { ui.navProfilePic.src = 'https://placehold.co/80x80/e9ecef/343a40?text=E'; };
            } else {
                ui.userProfileName.textContent = `Hi, Pengguna`;
                ui.navProfilePic.src = 'https://placehold.co/80x80/e9ecef/343a40?text=F';
            }
            ui.userProfile.classList.remove('hidden');
            if (window.location.hash === '#login') { window.location.hash = '#beranda'; }
        }
        function showLoggedOutView() {
            ui.loginButton.classList.remove('hidden');
            ui.userProfile.classList.add('hidden');
            ui.attendanceNav.classList.add('hidden');
            ui.sistemInformasiNav.classList.add('hidden');
            ui.kalenderPendidikan.classList.add('hidden');
            localStorage.removeItem('userSession');
            sessionStorage.removeItem('userSession');
            const protectedHashes = ['#absensi', '#profile', '#sistem-informasi'];
            if (protectedHashes.includes(window.location.hash)) { window.location.hash = '#beranda'; }
        }
        function renderNewsCards() { const container = document.getElementById('news-container'); if (container) container.innerHTML = appData.news.map(item => `<div class="card"><img src="${item.img}" alt="${item.title}" onerror="this.onerror=null;this.src='https://placehold.co/400x200/cccccc/FFFFFF?text=Error';"><div class="card-content"><h3>${item.title}</h3><p class="meta">${item.meta}</p><p>${item.desc}</p></div></div>`).join(''); }
        function renderGalleryCards() { const container = document.getElementById('gallery-container'); if (container) container.innerHTML = appData.gallery.map(item => `<div class="card"><img src="${item.img}" alt="${item.title}" onerror="this.onerror=null;this.src='https://placehold.co/400x250/cccccc/FFFFFF?text=Error';"><div class="card-content"><h3>${item.title}</h3><p>${item.desc}</p></div></div>`).join(''); }
        function fetchMarqueeText() { const session = getActiveSession(); const isLoggedIn = !!(session && session.loggedIn); const data = { action: 'getMarqueeText', isLoggedIn: isLoggedIn }; fetch(CONFIG.SCRIPT_URL, { method: 'POST', body: JSON.stringify(data), headers: { 'Content-Type': 'text/plain;charset=utf-8' } }).then(res => res.ok ? res.json() : Promise.reject(res)).then(result => { if (result.status === 'success' && result.text && result.text.trim() !== '') { const textContent = ` ${result.text} ••• `; ui.marqueeText.textContent = textContent.repeat(10); ui.marqueeContainer.classList.remove('hidden'); } else { ui.marqueeContainer.classList.add('hidden'); } }).catch(error => { console.error('Error fetching marquee text:', error); ui.marqueeContainer.classList.add('hidden'); }); }
        
        function renderDynamicCalendar(startYear, startMonth, numMonths) {
            if (!ui.dynamicCalendarGrid) return;
            ui.dynamicCalendarGrid.innerHTML = '';
            const today = new Date();
            const todayStr = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
            const monthNames = ["Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "November", "Desember"];
            let currentYear = startYear; let currentMonth = startMonth - 1;
            for (let i = 0; i < numMonths; i++) {
                const monthDate = new Date(currentYear, currentMonth, 1);
                const monthName = monthNames[monthDate.getMonth()];
                const year = monthDate.getFullYear();
                const firstDay = monthDate.getDay();
                const daysInMonth = new Date(year, monthDate.getMonth() + 1, 0).getDate();
                let monthHtml = `<div class="calendar-month"><h3 class="font-bold text-lg text-center mb-4 text-gray-700">${monthName} ${year}</h3><div class="grid grid-cols-7 gap-1 text-center text-xs text-gray-500 font-semibold mb-2"><div class="holiday">Mgg</div><div>Sen</div><div>Sel</div><div>Rab</div><div>Kam</div><div>Jum</div><div>Sab</div></div><div class="grid grid-cols-7 gap-1 text-center text-sm">`;
                for (let j = 0; j < firstDay; j++) { monthHtml += `<div></div>`; }
                for (let day = 1; day <= daysInMonth; day++) {
                    const dateStr = `${year}-${String(monthDate.getMonth() + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                    let dayClasses = 'py-1 relative';
                    if (new Date(dateStr).getDay() === 0) dayClasses += ' holiday';
                    if (dateStr === todayStr) dayClasses += ' today';
                    appData.calendarEvents.forEach(event => { const eventStartDate = new Date(event.date); const eventEndDate = new Date(eventStartDate); if (event.span) { eventEndDate.setDate(eventStartDate.getDate() + event.span - 1); } const currentDate = new Date(dateStr); if (currentDate >= eventStartDate && currentDate <= eventEndDate) { dayClasses += ` rounded-md ${event.color}`; } });
                    monthHtml += `<div class="${dayClasses}" data-date="${dateStr}">${day}</div>`;
                }
                monthHtml += `</div><div class="mt-auto pt-3 border-t text-xs space-y-2">`;
                const monthEvents = appData.calendarEvents.filter(e => new Date(e.date).getMonth() === monthDate.getMonth() && new Date(e.date).getFullYear() === year);
                const uniqueEvents = [...new Map(monthEvents.map(item => [item.title, item])).values()];
                uniqueEvents.forEach(event => {
                    const startDate = new Date(event.date); let legendText;
                    if (event.span && event.span > 1) { const endDate = new Date(startDate); endDate.setDate(startDate.getDate() + event.span - 1); if(startDate.getMonth() !== endDate.getMonth()) { legendText = `${startDate.getDate()} ${monthNames[startDate.getMonth()]} - ${endDate.getDate()} ${monthNames[endDate.getMonth()]}: ${event.title}`; } else { legendText = `${startDate.getDate()}-${endDate.getDate()}: ${event.title}`; } } else { legendText = `${startDate.getDate()}: ${event.title}`; }
                    if (event.color === 'holiday') { monthHtml += `<div class="flex items-center"><span class="holiday">${legendText}</span></div>`; } else if (event.color) { monthHtml += `<div class="flex items-center"><span class="w-3 h-3 rounded-sm mr-2 ${event.color}"></span><span>${legendText}</span></div>`; } else { monthHtml += `<div class="flex items-center"><span>${legendText}</span></div>`; }
                });
                monthHtml += `</div></div>`;
                ui.dynamicCalendarGrid.innerHTML += monthHtml;
                currentMonth++; if (currentMonth > 11) { currentMonth = 0; currentYear++; }
            }
        }
        function setupSlideshow() {
            if (!ui.slideshowContainer) return;
            appData.heroImages.forEach((img, index) => {
                const slide = document.createElement('div');
                slide.className = 'slide';
                slide.style.backgroundImage = `url('${img}')`;
                if (index === 0) slide.classList.add('active');
                ui.slideshowContainer.appendChild(slide);
            });
            let currentSlide = 0;
            const slides = ui.slideshowContainer.querySelectorAll('.slide');
            setInterval(() => {
                slides[currentSlide].classList.remove('active');
                currentSlide = (currentSlide + 1) % slides.length;
                slides[currentSlide].classList.add('active');
            }, 5000);
        }
        function populateTeacherClasses(session, selectedDateStr) {
            const selectedDate = new Date(selectedDateStr + 'T00:00:00'); // Ensure it's parsed as local time
            const dayIndex = selectedDate.getDay();
            const daysInIndonesian = ["Minggu", "Senin", "Selasa", "Rabu", "Kamis", "Jumat", "Sabtu"];
            const currentDayName = daysInIndonesian[dayIndex];
            const classNameSelect = document.getElementById('className');
            classNameSelect.innerHTML = '<option value="">Memuat kelas...</option>';
            if (session && session.loggedIn && session.userData) {
                const username = session.userData.username;
                const teacherName = session.userData.profileName;
                let taughtClasses = new Set();
                
                // Special case for user 'reza'
                if (username === 'reza' && dayIndex >= 1 && dayIndex <= 6) { // Monday to Saturday
                    taughtClasses.add("KELAS SD");
                } else {
                    for (const monthKey in appData.schedules) {
                        appData.schedules[monthKey].forEach(scheduleItem => {
                            if (scheduleItem.teacher === teacherName && scheduleItem.day === currentDayName) {
                                taughtClasses.add(scheduleItem.subject);
                            }
                        });
                    }
                }

                classNameSelect.innerHTML = '';
                if (taughtClasses.size > 0) {
                    classNameSelect.innerHTML = '<option value="">Pilih Kelas...</option>';
                    taughtClasses.forEach(subject => {
                        const option = document.createElement('option');
                        option.value = subject;
                        option.textContent = subject;
                        classNameSelect.appendChild(option);
                    });
                } else {
                    classNameSelect.innerHTML = '<option value="">Tidak ada jadwal mengajar hari ini</option>';
                }
            } else {
                classNameSelect.innerHTML = '<option value="">Silakan login terlebih dahulu</option>';
            }
        }
        function setupEventListeners() {
            if (ui.donasiBtn) ui.donasiBtn.onclick = () => document.getElementById('donasiModal').style.display = "block";
            if (ui.userProfile) ui.userProfile.onclick = () => openProfileModal();
            document.querySelectorAll('.close-button').forEach(btn => { btn.onclick = () => { btn.closest('.modal').style.display = 'none'; }; });
            window.onclick = (event) => { if (event.target.classList.contains('modal')) { event.target.style.display = "none"; } }
            window.addEventListener('hashchange', updateActiveLink);
            document.querySelectorAll('.toggle-password').forEach(toggle => { toggle.innerHTML = CONFIG.ICONS.eye; toggle.addEventListener('click', function () { const input = this.parentElement.querySelector('input'); if (input.type === 'password') { input.type = 'text'; this.innerHTML = CONFIG.ICONS.eyeOff; } else { input.type = 'password'; this.innerHTML = CONFIG.ICONS.eye; } }); });
            document.getElementById('loginForm')?.addEventListener('submit', handleLoginSubmit);
            document.getElementById('profileForm')?.addEventListener('submit', handleProfileSubmit);
            document.getElementById('changePasswordForm')?.addEventListener('submit', handleChangePasswordSubmit);
            document.getElementById('forgotPasswordVerifyForm')?.addEventListener('submit', handleForgotVerifySubmit);
            document.getElementById('forgotPasswordResetForm')?.addEventListener('submit', handleForgotResetSubmit);
            document.getElementById('attendanceFormGuru')?.addEventListener('submit', (e) => handleAttendanceSubmit(e, 'guru'));
            document.getElementById('attendanceFormStaf')?.addEventListener('submit', (e) => handleAttendanceSubmit(e, 'staf'));
            document.getElementById('attendanceFormRapat')?.addEventListener('submit', (e) => handleAttendanceSubmit(e, 'rapat'));
            document.getElementById('logoutFromProfile')?.addEventListener('click', handleLogout);
            document.getElementById('changePasswordFromProfile')?.addEventListener('click', () => { document.getElementById('profileModal').style.display = 'none'; document.getElementById('changePasswordModal').style.display = 'block'; document.getElementById('changePasswordForm').reset(); });
            document.getElementById('forgotPasswordLink')?.addEventListener('click', (e) => { e.preventDefault(); document.getElementById('forgotPasswordModal').style.display = 'block'; });
            document.querySelectorAll('input[name="role"]').forEach(radio => { radio.addEventListener('change', function() { document.getElementById('attendanceFormGuru').classList.toggle('hidden', this.value !== 'guru'); document.getElementById('attendanceFormStaf').classList.toggle('hidden', this.value !== 'staf'); document.getElementById('attendanceFormRapat').classList.toggle('hidden', this.value !== 'rapat'); }); });
            document.getElementById('attendanceDateGuru').addEventListener('change', (e) => {
                populateTeacherClasses(getActiveSession(), e.target.value);
            });
        }
        function handleLoginSubmit(event) { event.preventDefault(); const form = event.target; const submitBtn = form.querySelector('button[type="submit"]'); submitBtn.textContent = "Memeriksa..."; submitBtn.disabled = true; const data = { action: 'login', username: form.username.value, password: form.password.value }; fetch(CONFIG.SCRIPT_URL, { method: 'POST', body: JSON.stringify(data), headers: { 'Content-Type': 'text/plain;charset=utf-8' } }).then(res => res.ok ? res.json() : Promise.reject(res)).then(result => { if (result.status === "success" && result.userData) { showMessage("Login berhasil!", 'success'); const sessionData = { loggedIn: true, username: result.userData.username, userData: result.userData }; if (document.getElementById('remember').checked) { localStorage.setItem('userSession', JSON.stringify(sessionData)); } else { sessionStorage.setItem('userSession', JSON.stringify(sessionData)); } showLoggedInView(result.userData); fetchMarqueeText(); } else { showMessage(result.message || "Username atau password salah.", 'error'); } }).catch(error => { console.error('Login Error:', error); showMessage(`Gagal terhubung.`, 'error'); }).finally(() => { submitBtn.textContent = "Masuk"; submitBtn.disabled = false; }); }
        function handleLogout() { document.getElementById('profileModal').style.display = 'none'; showLoggedOutView(); fetchMarqueeText(); showMessage("Anda telah berhasil logout.", "success"); }
        function openProfileModal() { const session = getActiveSession(); if (session && session.userData) { const ud = session.userData; document.getElementById('profileName').value = ud.profileName || ''; document.getElementById('profileDob').value = ud.dob || ''; document.getElementById('profileAddress').value = ud.address || ''; document.getElementById('profileJabatan').value = ud.jabatan || ''; document.getElementById('profileUsername').value = ud.username || ''; const preview = document.getElementById('profilePicturePreview'); preview.src = ud.profilePicture || 'https://placehold.co/128x128/e9ecef/343a40?text=F'; preview.onerror = () => { preview.src = 'https://placehold.co/128x128/e9ecef/343a40?text=E'; }; document.getElementById('profileModal').style.display = 'block'; } else { showMessage('Data profil tidak ditemukan.', 'error'); } }
        async function handleProfileSubmit(event) { event.preventDefault(); const submitBtn = event.target.querySelector('button[type="submit"]'); const file = document.getElementById('profilePictureInput').files[0]; const sendProfileDataToSheet = (imageUrl) => { submitBtn.textContent = "Menyimpan..."; const session = getActiveSession(); const data = { action: 'updateProfile', username: session.username, profileName: profileName.value, dob: profileDob.value, address: profileAddress.value, jabatan: profileJabatan.value, profilePicture: imageUrl }; if (!imageUrl) { delete data.profilePicture; } fetch(CONFIG.SCRIPT_URL, { method: 'POST', body: JSON.stringify(data), headers: { 'Content-Type': 'text/plain;charset=utf-8' } }).then(res => res.json()).then(result => { if(result.status === 'success' && result.updatedData) { showMessage('Profil berhasil diperbarui!', 'success'); session.userData = result.updatedData; if (localStorage.getItem('userSession')) { localStorage.setItem('userSession', JSON.stringify(session)); } else { sessionStorage.setItem('userSession', JSON.stringify(session)); } showLoggedInView(result.updatedData); document.getElementById('profileModal').style.display = 'none'; } else { showMessage(result.message || 'Gagal update.', 'error'); } }).catch(error => { console.error('Profile Update Error:', error); showMessage('Koneksi error.', 'error'); }).finally(() => { submitBtn.textContent = "Simpan"; submitBtn.disabled = false; }); }; submitBtn.disabled = true; if (file) { if (typeof imageCompression !== 'function') { showMessage('Library kompresi error.', 'error'); submitBtn.disabled = false; return; } const options = { maxSizeMB: 0.29, maxWidthOrHeight: 1024, useWebWorker: true, onProgress: (p) => { submitBtn.textContent = `Mengompres... ${Math.round(p)}%`; }, }; try { const compressedFile = await imageCompression(file, options); submitBtn.textContent = "Mengunggah..."; const formData = new FormData(); formData.append('file', compressedFile, file.name); formData.append('upload_preset', CONFIG.CLOUDINARY_UPLOAD_PRESET); const cloudinaryResponse = await fetch(CONFIG.CLOUDINARY_URL, { method: 'POST', body: formData }); if (!cloudinaryResponse.ok) { throw new Error(`Upload error: ${cloudinaryResponse.status}`); } const cloudinaryData = await cloudinaryResponse.json(); if (cloudinaryData.secure_url) { sendProfileDataToSheet(cloudinaryData.secure_url); } else { throw new Error('URL Cloudinary tidak ditemukan.'); } } catch (error) { console.error('Image Upload Error:', error); showMessage(`Error unggah foto: ${error.message}`, 'error'); submitBtn.textContent = "Simpan"; submitBtn.disabled = false; } } else { sendProfileDataToSheet(null); } }
        function handleChangePasswordSubmit(event) { event.preventDefault(); const newPassword = document.getElementById('newPassword').value; if (newPassword.length < 6) { showMessage('Password minimal 6 karakter.', 'error'); return; } if (newPassword !== document.getElementById('confirmNewPassword').value) { showMessage('Konfirmasi password tidak cocok.', 'error'); return; } const session = getActiveSession(); if (!session || !session.loggedIn) { showMessage('Sesi tidak valid.', 'error'); return; } const data = { action: 'changePassword', username: session.username, currentPassword: document.getElementById('currentPassword').value, newPassword: newPassword }; const submitBtn = event.target.querySelector('button[type="submit"]'); submitBtn.textContent = "Menyimpan..."; submitBtn.disabled = true; fetch(CONFIG.SCRIPT_URL, { method: 'POST', body: JSON.stringify(data), headers: { 'Content-Type': 'text/plain;charset=utf-8' } }).then(res => res.json()).then(result => { if (result.status === "success") { showMessage('Password berhasil diubah.', 'success'); document.getElementById('changePasswordModal').style.display = "none"; event.target.reset(); } else { showMessage(result.message || 'Gagal ubah password.', 'error'); } }).catch(error => console.error('Error:', error)).finally(() => { submitBtn.textContent = "Simpan"; submitBtn.disabled = false; }); }
        function handleForgotVerifySubmit(event) { event.preventDefault(); const submitBtn = event.target.querySelector('button[type="submit"]'); submitBtn.textContent = "Memeriksa..."; submitBtn.disabled = true; const data = { action: 'verifyUser', username: document.getElementById('forgotUsername').value, dob: document.getElementById('forgotDob').value }; fetch(CONFIG.SCRIPT_URL, { method: 'POST', body: JSON.stringify(data), headers: { 'Content-Type': 'text/plain;charset=utf-8' } }).then(res => res.json()).then(result => { if (result.status === "success") { window.verifiedUsername = data.username; document.getElementById('forgotPasswordStep1').classList.add('hidden'); document.getElementById('forgotPasswordStep2').classList.remove('hidden'); } else { showMessage(result.message || 'Verifikasi gagal.', 'error'); } }).catch(error => console.error('Error:', error)).finally(() => { submitBtn.textContent = "Verifikasi"; submitBtn.disabled = false; }); }
        function handleForgotResetSubmit(event) { event.preventDefault(); const newPassword = document.getElementById('forgotNewPassword').value; if (newPassword.length < 6) { showMessage('Password baru minimal 6 karakter.', 'error'); return; } if (newPassword !== document.getElementById('forgotConfirmPassword').value) { showMessage('Konfirmasi password tidak cocok.', 'error'); return; } const submitBtn = event.target.querySelector('button[type="submit"]'); submitBtn.textContent = "Menyimpan..."; submitBtn.disabled = true; const data = { action: 'resetPassword', username: window.verifiedUsername, newPassword: newPassword }; fetch(CONFIG.SCRIPT_URL, { method: 'POST', body: JSON.stringify(data), headers: { 'Content-Type': 'text/plain;charset=utf-8' } }).then(res => res.json()).then(result => { if (result.status === "success") { showMessage('Password berhasil direset! Silakan login.', 'success'); document.getElementById('forgotPasswordModal').style.display = 'none'; event.target.reset(); document.getElementById('forgotPasswordStep2').classList.add('hidden'); document.getElementById('forgotPasswordStep1').classList.remove('hidden'); } else { showMessage(result.message || 'Gagal reset password.', 'error'); } }).catch(error => console.error('Error:', error)).finally(() => { submitBtn.textContent = "Simpan"; submitBtn.disabled = false; }); }
        function handleAttendanceSubmit(event, role) { event.preventDefault(); const session = getActiveSession(); if (!session || !session.loggedIn) { showMessage('Anda harus login.', 'error'); window.location.hash = '#login'; return; } const form = event.target; const submitBtn = form.querySelector('button[type="submit"]'); submitBtn.textContent = "Mengirim..."; submitBtn.disabled = true; let data; if (role === 'guru') { data = { action: 'submitAttendance', role: 'guru', teacherName: session.userData.profileName, attendanceDate: form.querySelector('#attendanceDateGuru').value, className: form.querySelector('#className').value, lateMinutes: form.querySelector('#lateMinutesGuru').value || '0', remarks: form.querySelector('#remarksGuru').value }; } else if (role === 'staf') { data = { action: 'submitAttendance', role: 'staf', stafName: session.userData.profileName, attendanceDate: form.querySelector('#attendanceDateStaf').value, jabatan: form.querySelector('#jabatanStaf').value, lateMinutes: form.querySelector('#lateMinutesStaf').value || '0', remarks: form.querySelector('#remarksStaf').value }; } else { data = { action: 'submitAttendance', role: 'rapat', name: session.userData.profileName, date: form.querySelector('#rapatDate').value, startTime: form.querySelector('#rapatStartTime').value, endTime: form.querySelector('#rapatEndTime').value, remarks: form.querySelector('#rapatRemarks').value }; } fetch(CONFIG.SCRIPT_URL, { method: 'POST', body: JSON.stringify(data), headers: { 'Content-Type': 'text/plain;charset=utf-8' } }).then(res => res.ok ? res.json() : Promise.reject(res)).then(result => { if (result.status === "success") { showMessage('Absensi berhasil direkam!', 'success'); form.reset(); const today = new Date().toISOString().split('T')[0]; document.getElementById('attendanceDateGuru').value = today; document.getElementById('attendanceDateStaf').value = today; document.getElementById('rapatDate').value = today; showPage('#absensi'); } else { showMessage(result.message || 'Gagal mengirim absensi.', 'error'); } }).catch(error => { console.error('Attendance Error:', error); showMessage('Gagal terhubung.', 'error'); }).finally(() => { submitBtn.textContent = `Kirim Absensi ${role.charAt(0).toUpperCase() + role.slice(1)}`; submitBtn.disabled = false; }); }
        
        function updateActiveLink() { const hash = window.location.hash || '#beranda'; showPage(hash); document.querySelectorAll('#mainNav a:not(.auth-button)').forEach(a => { a.classList.toggle('active', a.getAttribute('href') === hash); }); }
        function updateDateTime() { const now = new Date(); const gregorianDate = new Intl.DateTimeFormat('id-ID', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' }).format(now); const hijriDate = new Intl.DateTimeFormat('id-ID-u-ca-islamic', { day: 'numeric', month: 'long', year: 'numeric' }).format(now); document.getElementById('date-display').innerHTML = `${gregorianDate}<br><span class="hijri-date">${hijriDate}</span>`; }
        
        function initializeApp() {
            updateDateTime();
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('attendanceDateGuru').value = today;
            document.getElementById('attendanceDateStaf').value = today;
            document.getElementById('rapatDate').value = today;
            const session = getActiveSession();
            if (session && session.loggedIn) { showLoggedInView(session.userData); } else { showLoggedOutView(); }
            updateActiveLink();
            setupEventListeners();
            renderNewsCards();
            renderGalleryCards();
            fetchMarqueeText();
            renderDynamicCalendar(2025, 7, 12);
            setupSlideshow();
            
            initializeSistemInformasi();

            const formattedToday = new Date().toISOString().slice(0, 10);
            const todayElement = document.querySelector(`.page-section:not(#sistem-informasi) [data-date="${formattedToday}"]`);
            if (todayElement) { todayElement.classList.add('today'); }
        }

        initializeApp();
    });
    </script>
</body>
</html>
