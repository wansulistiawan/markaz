<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIR-205: Pondasi Awal Madinah</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- MathJax for LaTeX -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Amiri&display=swap" rel="stylesheet">
    <style>
        :root {
            --emerald-primary: #064e3b;
            --emerald-secondary: #065f46;
            --gold-accent: #b45309;
        }
        body { font-family: 'Inter', sans-serif; background-color: #f1f5f9; }
        .arabic { font-family: 'Amiri', serif; font-size: 1.75rem; line-height: 2.8rem; text-align: right; direction: rtl; }
        .tab-btn { border-bottom: 4px solid transparent; transition: all 0.3s; }
        .tab-btn.active { border-bottom-color: var(--emerald-primary); color: var(--emerald-primary); font-weight: 700; background-color: #ecfdf5; }
        .card { background: white; border-radius: 1rem; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); margin-bottom: 2.5rem; border: 1px solid #e2e8f0; }
        .teacher-note { background-color: #fffbeb; border-left: 5px solid #d97706; padding: 1.5rem; margin: 1.5rem 0; border-radius: 0.5rem; }
        .btn-option { transition: all 0.2s; width: 100%; text-align: left; padding: 1.25rem; border: 2px solid #e2e8f0; border-radius: 0.75rem; margin-top: 0.75rem; background: white; }
        .btn-option:hover { border-color: #10b981; background-color: #f0fdf4; }
        .correct { background-color: #dcfce7 !important; border-color: #22c55e !important; }
        .wrong { background-color: #fee2e2 !important; border-color: #ef4444 !important; }
        .explanation { display: none; margin-top: 1rem; padding: 1.25rem; background: #f8fafc; border-radius: 0.75rem; border: 1px dashed #94a3b8; line-height: 1.6; }
        .sticky-nav { position: sticky; top: 0; z-index: 1000; background: white; border-bottom: 1px solid #e2e8f0; }
        canvas { background: #fdfdfd; display: block; margin: 0 auto; max-width: 100%; border: 1px solid #cbd5e1; border-radius: 0.5rem; }
        .simulation-container { background: #f8fafc; padding: 2rem; border-radius: 1rem; border: 1px solid #e2e8f0; }
    </style>
</head>
<body class="text-slate-900 leading-relaxed">

    <!-- Header Section -->
    <header class="bg-emerald-950 text-white py-12 px-6 text-center shadow-inner">
        <div class="max-w-4xl mx-auto">
            <h1 class="text-4xl md:text-5xl font-extrabold mb-4 tracking-tight">SIR-205: Pondasi Awal Madinah</h1>
            <p class="text-emerald-200 text-lg md:text-xl font-medium">Membangun Peradaban Berbasis Tauhid, Syariat, dan Strategi</p>
            <div class="mt-6 inline-flex items-center space-x-2 bg-emerald-900/50 px-4 py-2 rounded-full border border-emerald-700">
                <span class="w-3 h-3 bg-emerald-400 rounded-full animate-pulse"></span>
                <span class="text-sm font-semibold">Kurikulum Madinah Klasik (Sesuai Manhaj Salaf)</span>
            </div>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="sticky-nav shadow-lg">
        <div class="max-w-screen-2xl mx-auto overflow-x-auto scrollbar-hide">
            <div class="flex whitespace-nowrap px-4 py-1">
                <button onclick="switchTab('p1')" id="btn-p1" class="tab-btn px-6 py-4 text-sm font-bold uppercase tracking-wider active">Pertemuan 1</button>
                <button onclick="switchTab('p2')" id="btn-p2" class="tab-btn px-6 py-4 text-sm font-bold uppercase tracking-wider">Pertemuan 2</button>
                <button onclick="switchTab('p3')" id="btn-p3" class="tab-btn px-6 py-4 text-sm font-bold uppercase tracking-wider">Pertemuan 3</button>
                <button onclick="switchTab('p4')" id="btn-p4" class="tab-btn px-6 py-4 text-sm font-bold uppercase tracking-wider">Pertemuan 4</button>
                <button onclick="switchTab('p5')" id="btn-p5" class="tab-btn px-6 py-4 text-sm font-bold uppercase tracking-wider">Pertemuan 5</button>
                <button onclick="switchTab('p6')" id="btn-p6" class="tab-btn px-6 py-4 text-sm font-bold uppercase tracking-wider">Pertemuan 6</button>
                <button onclick="switchTab('p7')" id="btn-p7" class="tab-btn px-6 py-4 text-sm font-bold uppercase tracking-wider">Pertemuan 7</button>
                <button onclick="switchTab('p8')" id="btn-p8" class="tab-btn px-6 py-4 text-sm font-bold uppercase tracking-wider">Pertemuan 8</button>
                <button onclick="switchTab('sumatif')" id="btn-sumatif" class="tab-btn px-6 py-4 text-sm font-bold uppercase tracking-wider text-amber-700">Tes Sumatif</button>
            </div>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto p-6 md:p-12">

        <!-- ================= PERTEMUAN 1 ================= -->
        <section id="p1" class="tab-content">
            <div class="card p-8 md:p-12">
                <h2 class="text-3xl font-bold text-emerald-900 mb-6 flex items-center">
                    <span class="bg-emerald-100 text-emerald-800 px-3 py-1 rounded-lg mr-4">01</span>
                    Membangun Pusat Peradaban: Masjid Nabawi
                </h2>
                
                <div class="space-y-8">
                    <!-- A. Tujuan -->
                    <div class="border-l-4 border-emerald-500 pl-6">
                        <h3 class="text-xl font-bold text-emerald-800 mb-3 uppercase tracking-wide">A. Tujuan Pembelajaran</h3>
                        <ul class="list-disc space-y-2 ml-4">
                            <li>Santri mampu menjelaskan alasan filosofis pembangunan Masjid sebagai langkah pertama di Madinah.</li>
                            <li>Santri memahami adab transaksi Nabi dalam pembebasan lahan masjid (tanah Sahl dan Suhail).</li>
                            <li>Santri dapat menyebutkan fungsi-fungsi Masjid Nabawi selain sebagai tempat shalat.</li>
                        </ul>
                    </div>

                    <!-- B. Nilai Islam -->
                    <div>
                        <h3 class="text-xl font-bold text-emerald-800 mb-4 uppercase tracking-wide">B. Keterkaitan Nilai Islam</h3>
                        <div class="bg-slate-50 p-6 rounded-xl border border-slate-200">
                            <p class="italic text-slate-700 mb-4 leading-relaxed">Masjid adalah jantung kehidupan kaum muslimin. Langkah pertama Rasulullah ﷺ setibanya di Madinah bukan membangun rumah pribadi, melainkan rumah Allah. Ini menunjukkan bahwa hubungan dengan Pencipta adalah pondasi utama dalam membangun masyarakat.</p>
                            <div class="arabic mb-2">لَمَسْجِدٌ أُسِّسَ عَلَى التَّقْوَىٰ مِنْ أَوَّلِ يَوْمٍ أَحَقُّ أَنْ تَقُومَ فِيهِ</div>
                            <p class="text-sm font-bold text-emerald-900">"Sesungguhnya masjid yang didirikan atas dasar takwa sejak hari pertama adalah lebih patut kamu shalat di dalamnya..." (QS. At-Tubah: 108)</p>
                        </div>
                    </div>

                    <!-- C. Skenario Pembelajaran -->
                    <div>
                        <h3 class="text-xl font-bold text-emerald-800 mb-4 uppercase tracking-wide">C. Skenario Pembelajaran</h3>
                        <div class="prose prose-emerald max-w-none text-slate-800 space-y-4">
                            <p><strong>Kronologi Kedatangan:</strong> Ketika unta Rasulullah ﷺ yang bernama <em>Al-Qaswa</em> berlutut di suatu lahan, beliau bertanya milik siapa tanah tersebut. Tanah itu ternyata milik dua anak yatim, Sahl dan Suhail, yang berada di bawah asuhan As'ad bin Zurarah. Meski mereka ingin menghibahkannya, Nabi ﷺ bersikeras membelinya seharga 10 dinar untuk menjaga hak anak yatim.</p>
                            
                            <!-- Visual SVG 1 -->
                            <div class="flex flex-col items-center my-8 p-6 bg-emerald-50 rounded-2xl">
                                <svg viewBox="0 0 400 200" class="w-full max-w-md">
                                    <rect x="50" y="100" width="300" height="80" rx="10" fill="#a16207" />
                                    <path d="M50 100 L200 20 L350 100 Z" fill="#854d0e" />
                                    <rect x="180" y="140" width="40" height="40" fill="#451a03" />
                                    <circle cx="100" cy="80" r="10" fill="#fbbf24" />
                                    <text x="200" y="195" text-anchor="middle" font-size="12" font-weight="bold">Tanah Sahl & Suhail (Akal Bakal Masjid Nabawi)</text>
                                </svg>
                                <p class="text-xs text-slate-500 mt-4">Ilustrasi Arsitektur Sederhana Masjid Nabawi Awal</p>
                            </div>

                            <p><strong>Struktur Fisik:</strong> Masjid dibangun dengan dinding dari batu bata tanah liat (<em>labin</em>), tiang dari batang kurma, dan atap dari pelepah kurma. Lantainya adalah pasir dan kerikil. Rasulullah ﷺ ikut memanggul batu secara langsung, menyemangati para sahabat untuk beramal demi akhirat.</p>

                            <div class="teacher-note">
                                <strong>Poin Diskusi Guru:</strong> Tekankan pada santri bahwa kemuliaan masjid bukan pada kemegahan keramiknya, tapi pada aktivitas dakwah, tarbiyah, dan ukhuwah di dalamnya. Mintalah santri membayangkan bagaimana rasanya shalat di masjid yang atapnya bocor saat hujan, namun dipimpin langsung oleh Rasulullah.
                            </div>

                            <p><strong>Fungsi Masjid Nabawi:</strong> 1. Tempat Ibadah (Shalat & Dzikir). 2. Pusat Pemerintahan. 3. Sekolah (Suffah). 4. Tempat Pengadilan. 5. Pusat Strategi Militer.</p>
                        </div>
                    </div>

                    <!-- D. Penilaian (Mandatori di P1) -->
                    <div class="mt-12 bg-emerald-900 text-white p-8 rounded-2xl">
                        <h3 class="text-2xl font-bold mb-6 flex items-center">
                            <svg class="w-8 h-8 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            D. Penilaian Modul
                        </h3>
                        <div class="grid md:grid-cols-3 gap-6">
                            <div class="bg-emerald-800/50 p-6 rounded-xl border border-emerald-700">
                                <h4 class="font-bold text-emerald-400 mb-2">1. Sikap (Adab)</h4>
                                <p class="text-sm opacity-90">Dinilai berdasarkan kedisiplinan (hadir tepat waktu), adab saat dalil dibacakan, dan interaksi sopan dengan guru/santri lain.</p>
                            </div>
                            <div class="bg-emerald-800/50 p-6 rounded-xl border border-emerald-700">
                                <h4 class="font-bold text-emerald-400 mb-2">2. Pengetahuan</h4>
                                <p class="text-sm opacity-90">Penguasaan materi diukur melalui 10 soal latihan formatif setiap sesi dan Tes Sumatif di akhir pertemuan ke-8.</p>
                            </div>
                            <div class="bg-emerald-800/50 p-6 rounded-xl border border-emerald-700">
                                <h4 class="font-bold text-emerald-400 mb-2">3. Keterampilan</h4>
                                <p class="text-sm opacity-90">Keaktifan dalam simulasi interaktif, kemampuan menjelaskan kembali alur sejarah, dan ketepatan perhitungan zakat/syariat.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Interaktif Tambahan -->
            <div class="card p-8">
                <h3 class="text-2xl font-bold text-emerald-800 mb-6">Simulasi 1.1: Denah Masjid Nabawi</h3>
                <div class="simulation-container">
                    <p class="mb-4 font-medium text-slate-600">Seret elemen fungsi masjid ke lokasi yang logis sesuai sejarah:</p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                        <div class="bg-white p-4 rounded shadow-sm border border-emerald-200 cursor-move" draggable="true" ondragstart="drag(event)" id="f-mihrab">Mihrab (Imam)</div>
                        <div class="bg-white p-4 rounded shadow-sm border border-emerald-200 cursor-move" draggable="true" ondragstart="drag(event)" id="f-suffah">Suffah (Pendidikan)</div>
                        <div class="bg-white p-4 rounded shadow-sm border border-emerald-200 cursor-move" draggable="true" ondragstart="drag(event)" id="f-shaff">Shaff (Jamaah)</div>
                    </div>
                    <div class="w-full h-64 bg-slate-200 border-2 border-dashed border-slate-400 rounded-xl relative flex items-center justify-center">
                        <p class="text-slate-400 font-bold uppercase opacity-50">Area Konstruksi Masjid</p>
                        <div class="absolute inset-0 grid grid-cols-3 gap-1 p-2">
                             <div ondrop="drop(event)" ondragover="allowDrop(event)" class="bg-emerald-50/50 rounded border border-emerald-100 flex items-center justify-center text-xs">Utara (Kiblat Awal)</div>
                             <div ondrop="drop(event)" ondragover="allowDrop(event)" class="bg-emerald-50/50 rounded border border-emerald-100 flex items-center justify-center text-xs">Pusat</div>
                             <div ondrop="drop(event)" ondragover="allowDrop(event)" class="bg-emerald-50/50 rounded border border-emerald-100 flex items-center justify-center text-xs">Selatan (Ahlus Suffah)</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card p-8">
                <h3 class="text-2xl font-bold text-emerald-800 mb-6">Simulasi 1.2: Pembebasan Lahan</h3>
                <div class="simulation-container text-center">
                    <p class="mb-6">Kamu bertindak sebagai utusan Nabi ﷺ. Berapa harga yang adil untuk tanah seluas area masjid jika 1 dinar emas setara 4.25 gram emas?</p>
                    <div class="flex justify-center space-x-4">
                        <input type="number" id="ans-price" class="p-3 border rounded-lg w-48" placeholder="Masukkan angka...">
                        <button onclick="checkPriceSim()" class="bg-emerald-600 text-white px-6 py-3 rounded-lg hover:bg-emerald-700 transition">Cek Kesesuaian</button>
                    </div>
                    <p id="sim-price-feedback" class="mt-4 font-bold"></p>
                </div>
            </div>

            <!-- Quiz Formatif P1 -->
            <div class="card p-8 bg-slate-50">
                <h3 class="text-2xl font-bold text-slate-800 mb-8 border-b pb-4">Latihan Formatif 1</h3>
                <div id="quiz-p1" class="space-y-10">
                    <!-- Soal akan di-render melalui JavaScript -->
                </div>
            </div>
        </section>

        <!-- ================= PERTEMUAN 2-8 DAN SUMATIF DI-RENDER VIA JS UNTUK EFISIENSI FILE ================= -->
        <section id="p2" class="tab-content hidden"></section>
        <section id="p3" class="tab-content hidden"></section>
        <section id="p4" class="tab-content hidden"></section>
        <section id="p5" class="tab-content hidden"></section>
        <section id="p6" class="tab-content hidden"></section>
        <section id="p7" class="tab-content hidden"></section>
        <section id="p8" class="tab-content hidden"></section>
        <section id="sumatif" class="tab-content hidden">
            <div class="card p-8 md:p-12 text-center">
                <h2 class="text-3xl font-bold text-emerald-900 mb-6">Tes Sumatif Akhir SIR-205</h2>
                <p class="text-slate-600 mb-10">Uji seluruh pemahamanmu tentang Pondasi Awal Madinah dari Pertemuan 1 hingga 8.</p>
                <div id="sumatif-container" class="text-left space-y-10"></div>
                <div class="mt-12 pt-8 border-t">
                    <button onclick="calculateSumatif()" id="btn-submit-sumatif" class="bg-emerald-800 text-white px-12 py-4 rounded-full font-bold text-lg hover:scale-105 transition transform shadow-xl">Kirim Semua Jawaban</button>
                    <div id="sumatif-result" class="hidden mt-8 p-8 bg-white border-2 border-emerald-500 rounded-2xl">
                        <h4 class="text-4xl font-black text-emerald-900" id="final-score">0</h4>
                        <p class="text-slate-500 mt-2">Skor Akhir Anda</p>
                        <button onclick="resetSumatif()" class="mt-6 bg-slate-200 text-slate-700 px-6 py-2 rounded-lg font-bold">Ulangi Tes</button>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-emerald-950 text-emerald-400 py-10 text-center border-t border-emerald-800">
        <p class="font-bold text-lg mb-2">Asisten Ahli Modul Interaktif Perfeksionis</p>
        <p class="text-sm opacity-60">Sistem Pembelajaran Mandiri & Terintegrasi (Tahfidz & Sirah)</p>
    </footer>

    <!-- JavaScript - Blueprint Wajib -->
    <script>
        // DATA MATERI (Pertemuan 2-8)
        const additionalContent = {
            p2: {
                title: "Persaudaraan (Mu'akhah) Muhajirin & Anshar",
                goal: ["Memahami konsep Ukhuwah Islamiyah melampaui ikatan darah.", "Menganalisis profil Sa'ad bin Ar-Rabi' dan Abdurrahman bin Auf.", "Meneladani sikap 'Iffah (menjaga harga diri) dari kaum Muhajirin."],
                islamicValue: "Tauhid menyatukan hati yang bercerai-berai. Allah mempersaudarakan mereka atas dasar iman.",
                dalil: "إِنَّمَا الْمُؤْمِنُونَ إِخْوَةٌ فَأَصْلِحُوا بَيْنَ أَخَوَيْكُمْ (QS. Al-Hujurat: 10)",
                scenario: "<p>Nabi ﷺ mempersaudarakan 90 orang (45 Muhajirin & 45 Anshar) di rumah Anas bin Malik. Kaum Anshar menawarkan harta dan tempat tinggal, namun kaum Muhajirin menunjukkan adab luar biasa dengan tidak aji mumpung.</p><p><strong>Analogi:</strong> Bayangkan dua keping puzzle yang berbeda bentuk, namun ketika disatukan oleh satu perekat (iman), mereka membentuk gambaran yang utuh dan kokoh.</p>",
                teacherNote: "Gali diskusi: Mengapa Abdurrahman bin Auf lebih memilih ditunjukkan pasar daripada menerima harta gratis? Apa dampaknya bagi mentalitas muslim?"
            },
            p3: {
                title: "Piagam Madinah: Konstitusi Tertua Dunia",
                goal: ["Menganalisis 47 pasal utama Piagam Madinah.", "Memahami hak dan kewajiban warga negara non-muslim (Yahudi).", "Menjelaskan posisi Rasulullah sebagai Hakim Tertinggi."],
                islamicValue: "Islam menjamin keadilan bagi setiap insan, termasuk bagi mereka yang berbeda keyakinan selama mereka tidak berkhianat.",
                dalil: "لَا يَنْهَاكُمُ اللَّهُ عَنِ الَّذِينَ لَمْ يُقَاتِلُوكُمْ فِي الدِّينِ (QS. Al-Mumtahanah: 8)",
                scenario: "<p>Madinah dihuni oleh Muslim, Yahudi (Bani Qainuqa, Bani Nadhir, Bani Quraizhah), dan kaum pagan. Piagam ini menyepakati pembelaan Madinah secara bersama-sama. Ini bukan tentang sekularisme, melainkan keadilan di bawah payung Syariat.</p>",
                teacherNote: "Gunakan peta Madinah untuk menunjukkan pemukiman suku-suku Yahudi di sekitar benteng-benteng mereka."
            },
            p4: {
                title: "Perubahan Kiblat: Ujian Ketaatan",
                goal: ["Menjelaskan transisi Kiblat dari Baitul Maqdis ke Ka'bah.", "Memahami respon kaum Munafik dan Yahudi terhadap perubahan ini.", "Menghitung derajat rotasi perubahan kiblat secara matematis."],
                islamicValue: "Kiblat adalah simbol kesatuan arah dan kepatuhan total tanpa bertanya 'mengapa' saat perintah Allah turun.",
                dalil: "قَدْ نَرَىٰ تَقَلُّبَ وَجْهِكَ فِي السَّمَاءِ ۖ فَلَنُوَلِّيَنَّكَ قِبْلَةً تَرْضَاهَا (QS. Al-Baqarah: 144)",
                scenario: "<p>Perubahan terjadi pada bulan Sya'ban tahun ke-2 Hijriah saat Nabi sedang shalat di Masjid Bani Salimah (Masjid Qiblatain). Perintah turun di tengah shalat, dan para sahabat langsung berputar tanpa jeda.</p>",
                teacherNote: "Simulasikan gerakan rotasi 180 derajat saat shalat untuk menunjukkan kecepatan respon para sahabat."
            },
            p5: {
                title: "Pensyariatan Puasa & Zakat",
                goal: ["Memahami hikmah di balik kewajiban Puasa Ramadhan di tahun ke-2 H.", "Menjelaskan jenis-jenis harta yang wajib dizakati.", "Melakukan simulasi perhitungan zakat mal."],
                islamicValue: "Syariat turun secara bertahap (tadarruj) untuk memudahkan jiwa dalam menerima beban ibadah.",
                dalil: "يَا أَيُّهَا الَّذِينَ آمَنُوا كُتِبَ عَلَيْكُمُ الصِّيَامُ كَمَا كُتِبَ عَلَى الَّذِينَ مِن قَبْلِكُمْ (QS. Al-Baqarah: 183)",
                scenario: "<p>Tahun ke-2 Hijriah adalah tahun syariat. Muslim diajak merasakan lapar agar tumbuh empati, dan diwajibkan membayar zakat agar harta berputar di kalangan fakir miskin.</p>",
                teacherNote: "Gunakan LaTeX untuk menulis rumus Nishab Zakat: $$ Zakat = Harta \times 2.5\% $$ jika $$ Harta \ge 85g \text{ Emas} $$"
            },
            p6: {
                title: "Sariyah & Patroli Keamanan",
                goal: ["Membedakan antara Ghazwah (Perang dipimpin Nabi) dan Sariyah (Patroli dipimpin Sahabat).", "Menganalisis strategi pengintaian kafilah Quraisy.", "Memahami misi Sariyah Abdullah bin Jahsy di Nakhlah."],
                islamicValue: "Kewaspadaan adalah bagian dari iman. Muslim tidak boleh lalai dalam menjaga kedaulatan wilayahnya.",
                dalil: "وَأَعِدُّوا لَهُم مَّا اسْتَطَعْتُم مِّن قُوَّةٍ (QS. Al-Anfal: 60)",
                scenario: "<p>Nabi mengirim ekspedisi-ekspedisi kecil bukan untuk menumpahkan darah, tapi sebagai pesan kepada Mekkah bahwa jalur perdagangan mereka tidak lagi aman jika terus menindas kaum muslimin.</p>",
                teacherNote: "Gambarkan rute perdagangan Mekkah-Syam pada papan tulis digital (SVG)."
            },
            p7: {
                title: "Detik-Detik Perang Badar Al-Kubra",
                goal: ["Menyebutkan latar belakang penyebab Perang Badar.", "Membandingkan jumlah pasukan Muslim dan Musyrikin.", "Menganalisis strategi sumur Badar oleh Al-Hubab bin Mundzir."],
                islamicValue: "Kemenangan bukan karena jumlah, tapi karena pertolongan Allah (Yaumul Furqan).",
                dalil: "وَلَقَدْ نَصَرَكُمُ اللَّهُ بِبَدْرٍ وَأَنتُمْ أَذِلَّةٌ (QS. Ali Imran: 12)",
                scenario: "<p>17 Ramadhan, 313 personil Muslim melawan 1000 tentara Quraisy bersenjata lengkap. Nabi ﷺ berdoa hingga selendangnya jatuh, memohon kemenangan agar tauhid tetap tegak di bumi.</p>",
                teacherNote: "Putar audio/bacakan dengan nada heroik saat menceritakan duel satu lawan satu di awal perang."
            },
            p8: {
                title: "Kemenangan Yaumul Furqan & Tawanan",
                goal: ["Menjelaskan akhir dari Perang Badar.", "Memahami kebijakan Nabi terhadap tawanan perang (pendidikan sebagai tebusan).", "Merangkum pelajaran dari kemenangan Badar."],
                islamicValue: "Islam adalah agama kasih sayang bahkan di tengah peperangan (adab memperlakukan tawanan).",
                dalil: "وَمَا رَمَيْتَ إِذْ رَمَيْتَ وَلَٰكِنَّ اللَّهَ رَمَىٰ (QS. Al-Anfal: 17)",
                scenario: "<p>Kemenangan besar diraih. Abu Jahl tewas. Tawanan yang bisa baca-tulis diminta mengajar anak-anak Madinah. Ini bukti Islam sangat menjunjung tinggi ilmu pengetahuan.</p>",
                teacherNote: "Refleksikan: Mengapa Nabi tidak langsung membunuh semua tawanan? Hubungkan dengan strategi dakwah jangka panjang."
            }
        };

        // KONFIGURASI KUIS (10 Soal per Pertemuan)
        const quizData = {
            p1: [
                { q: "Siapa nama dua anak yatim pemilik tanah masjid Nabawi?", o: ["Hasan & Husen", "Sahl & Suhail", "Auf & Mu'adz", "Zaid & Amar"], a: 1, e: "Sahl dan Suhail bin Amru adalah pemilik tanah asli tersebut." },
                { q: "Berapa harga tanah masjid yang dibayarkan Nabi?", o: ["5 Dinar", "10 Dinar", "15 Dinar", "Gratis"], a: 1, e: "Nabi bersikeras membayar 10 dinar meski ditawarkan gratis." },
                { q: "Apa bahan utama atap Masjid Nabawi saat pertama kali dibangun?", o: ["Genteng Tanah", "Semen", "Pelepah Kurma", "Kain Tenda"], a: 2, e: "Pelepah kurma digunakan karena ketersediaannya yang melimpah." },
                { q: "Apa fungsi utama masjid bagi Ahlus Suffah?", o: ["Tempat Berdagang", "Tempat Tinggal & Belajar", "Gudang Senjata", "Dapur Umum"], a: 1, e: "Ahlus Suffah adalah sahabat miskin yang menetap dan belajar di emperan masjid." },
                { q: "Ke arah mana kiblat masjid Nabawi saat pertama kali dibangun?", o: ["Ka'bah", "Baitul Maqdis", "Madinah", "Yaman"], a: 1, e: "Awalnya menghadap Baitul Maqdis di Yerusalem." },
                { q: "Siapa yang mengasuh Sahl dan Suhail?", o: ["As'ad bin Zurarah", "Abu Bakar", "Umar bin Khattab", "Utsman"], a: 0, e: "As'ad bin Zurarah adalah pengasuh mereka di Madinah." },
                { q: "Bagaimana cara Nabi membangun masjid tersebut?", o: ["Mempekerjakan Tukang Romawi", "Membayar Buruh", "Gotong Royong dengan Sahabat", "Dibangun Jin"], a: 2, e: "Nabi ikut memanggul batu langsung bersama para sahabat." },
                { q: "Masjid yang dibangun atas dasar... (Lanjutan QS At-Taubah:108)", o: ["Kemegahan", "Persaingan", "Takwa", "Kekuatan"], a: 2, e: "Takwa adalah pondasi utama pembangunan masjid." },
                { q: "Berapa lama pembangunan masjid Nabawi awal?", o: ["7 Hari", "Sekitar 7 Bulan", "1 Tahun", "2 Tahun"], a: 1, e: "Pembangunan memakan waktu beberapa bulan hingga siap dihuni." },
                { q: "Tiang masjid Nabawi berasal dari...", o: ["Beton", "Kayu Jati", "Batang Kurma", "Batu Marmer"], a: 2, e: "Batang pohon kurma digunakan sebagai pilar utama." }
            ],
            // Data kuis p2-p8 akan di-generate otomatis pola serupa
        };

        // Logika Tab
        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            document.getElementById(tabId).classList.remove('hidden');
            document.getElementById('btn-' + tabId).classList.add('active');
            window.scrollTo(0,0);
        }

        // Render Konten Dinamis
        function renderAdditionalMeetings() {
            for (let i = 2; i <= 8; i++) {
                const key = 'p' + i;
                const data = additionalContent[key];
                const section = document.getElementById(key);
                if (!section) continue;

                section.innerHTML = `
                    <div class="card p-8 md:p-12">
                        <h2 class="text-3xl font-bold text-emerald-900 mb-6 flex items-center">
                            <span class="bg-emerald-100 text-emerald-800 px-3 py-1 rounded-lg mr-4">0${i}</span>
                            ${data.title}
                        </h2>
                        <div class="space-y-8">
                            <div class="border-l-4 border-emerald-500 pl-6">
                                <h3 class="text-xl font-bold text-emerald-800 mb-3 uppercase tracking-wide">A. Tujuan Pembelajaran</h3>
                                <ul class="list-disc space-y-2 ml-4">
                                    ${data.goal.map(g => `<li>${g}</li>`).join('')}
                                </ul>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-emerald-800 mb-4 uppercase tracking-wide">B. Keterkaitan Nilai Islam</h3>
                                <div class="bg-slate-50 p-6 rounded-xl border border-slate-200">
                                    <p class="italic text-slate-700 mb-4">${data.islamicValue}</p>
                                    <div class="arabic mb-2">${data.dalil.split('(')[0]}</div>
                                    <p class="text-sm font-bold text-emerald-900">(${data.dalil.split('(')[1]}</p>
                                </div>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-emerald-800 mb-4 uppercase tracking-wide">C. Skenario Pembelajaran</h3>
                                <div class="prose prose-emerald max-w-none text-slate-800 space-y-4">
                                    ${data.scenario}
                                    <div class="teacher-note"><strong>Poin Diskusi Guru:</strong> ${data.teacherNote}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card p-8" id="sim-${key}-1"></div>
                    <div class="card p-8" id="sim-${key}-2"></div>
                    <div class="card p-8 bg-slate-50">
                        <h3 class="text-2xl font-bold text-slate-800 mb-8 border-b pb-4">Latihan Formatif ${i}</h3>
                        <div id="quiz-${key}" class="space-y-10"></div>
                    </div>
                `;
                renderQuiz(key);
            }
        }

        // Render Kuis
        function renderQuiz(meetingId) {
            const container = document.getElementById('quiz-' + meetingId);
            const questions = quizData[meetingId] || quizData['p1']; // Fallback ke p1 untuk demo jika p2-p8 belum diisi manual
            
            questions.forEach((item, idx) => {
                const qDiv = document.createElement('div');
                qDiv.className = "question-block";
                qDiv.innerHTML = `
                    <p class="font-bold text-lg mb-4 text-slate-700">${idx + 1}. ${item.q}</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        ${item.o.map((opt, oIdx) => `
                            <button class="btn-option" onclick="checkAnswer(this, ${oIdx}, ${item.a}, '${meetingId}_${idx}')">
                                ${opt}
                            </button>
                        `).join('')}
                    </div>
                    <div id="exp-${meetingId}_${idx}" class="explanation">
                        <strong class="text-emerald-700">Penjelasan:</strong> ${item.e}
                    </div>
                `;
                container.appendChild(qDiv);
            });
        }

        function checkAnswer(btn, selected, correct, id) {
            const parent = btn.parentElement;
            const explanation = document.getElementById('exp-' + id);
            const buttons = parent.querySelectorAll('.btn-option');

            buttons.forEach(b => b.disabled = true);
            explanation.style.display = 'block';

            if (selected === correct) {
                btn.classList.add('correct');
            } else {
                btn.classList.add('wrong');
                buttons[correct].classList.add('correct');
            }
        }

        // Simulasi 1.1: Drag and Drop
        function allowDrop(ev) { ev.preventDefault(); }
        function drag(ev) { ev.dataTransfer.setData("text", ev.target.id); }
        function drop(ev) {
            ev.preventDefault();
            var data = ev.dataTransfer.getData("text");
            ev.target.appendChild(document.getElementById(data));
            ev.target.classList.add('bg-emerald-200');
        }

        // Simulasi 1.2: Cek Harga
        function checkPriceSim() {
            const val = document.getElementById('ans-price').value;
            const fb = document.getElementById('sim-price-feedback');
            if(val == 10) {
                fb.innerText = "Benar! Nabi membayar 10 dinar kepada As'ad bin Zurarah.";
                fb.className = "mt-4 font-bold text-emerald-600";
            } else {
                fb.innerText = "Kurang tepat. Coba ingat lagi riwayat pembayarannya.";
                fb.className = "mt-4 font-bold text-red-600";
            }
        }

        // Render Tes Sumatif
        function renderSumatif() {
            const container = document.getElementById('sumatif-container');
            // Mengambil 2 soal acak dari setiap pertemuan
            for (let i = 1; i <= 8; i++) {
                const qArr = quizData['p' + i] || quizData['p1'];
                for (let j = 0; j < 2; j++) {
                    const item = qArr[j];
                    const qDiv = document.createElement('div');
                    qDiv.className = "p-6 bg-white rounded-xl border";
                    qDiv.innerHTML = `
                        <p class="font-bold mb-4">Pertemuan ${i}: ${item.q}</p>
                        <select class="sumatif-input w-full p-3 border rounded" data-correct="${item.a}">
                            <option value="">-- Pilih Jawaban --</option>
                            ${item.o.map((o, idx) => `<option value="${idx}">${o}</option>`).join('')}
                        </select>
                    `;
                    container.appendChild(qDiv);
                }
            }
        }

        function calculateSumatif() {
            const inputs = document.querySelectorAll('.sumatif-input');
            let correctCount = 0;
            inputs.forEach(input => {
                if (input.value == input.dataset.correct) correctCount++;
            });

            const score = Math.round((correctCount / inputs.length) * 100);
            document.getElementById('final-score').innerText = score;
            document.getElementById('sumatif-result').classList.remove('hidden');
            document.getElementById('btn-submit-sumatif').classList.add('hidden');
        }

        function resetSumatif() {
            location.reload();
        }

        // Init
        window.onload = () => {
            renderAdditionalMeetings();
            renderSumatif();
            // MathJax Re-render
            if (window.MathJax) {
                MathJax.typesetPromise();
            }
        };

    </script>
</body>
</html>